{"ast":null,"code":"import _toConsumableArray from\"/Users/evik/kl/project-2024/klasmart-assessment-frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/evik/kl/project-2024/klasmart-assessment-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from\"react\";import{makeStyles}from\"@material-ui/core/styles\";import Table from\"@material-ui/core/Table\";import TableBody from\"@material-ui/core/TableBody\";import TableCell from\"@material-ui/core/TableCell\";import TableContainer from\"@material-ui/core/TableContainer\";import TableRow from\"@material-ui/core/TableRow\";import Paper from\"@material-ui/core/Paper\";import{PLTableHeader}from\"./PLTableHeader\";import{cloneDeep,sortBy}from\"lodash\";import clsx from\"clsx\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles({table:{minWidth:650}});/** 排序 ---- 切换排序方式 **/var toggleSortString=function toggleSortString(sortType){return sortType===undefined?\"asc\":sortType===\"asc\"?\"desc\":undefined;};export var sortData=function sortData(fieldID,rows,sortType){return sortType===\"desc\"?sortBy(rows,[fieldID]).reverse():sortBy(rows,[fieldID]);};export function PLTable(props){var classes=useStyles();var sortChange=props.sortChange,clickRows=props.clickRows,dblclickRows=props.dblclickRows,loading=props.loading,className=props.className,style=props.style;var _useState=useState(props.fields),_useState2=_slicedToArray(_useState,2),fields=_useState2[0],setFields=_useState2[1];var _useState3=useState(props.rows),_useState4=_slicedToArray(_useState3,2),rows=_useState4[0],setRows=_useState4[1];var defaultRows=cloneDeep(props.rows);/** 默认的数据，用于排序和筛选 **/var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),sortField=_useState6[0],setSortField=_useState6[1];/** 表头排序事件 **/var emitSort=function emitSort(fieldID,event){setSortField(fieldID);var curField;fields.forEach(function(f){if(f.value===fieldID){f.sortType=toggleSortString(f.sortType);curField=f;}else{f.sortType=undefined;}});fields=_toConsumableArray(fields);setFields(fields);if(sortChange)sortChange(curField,event);/** 更改排序事件的回调 **/else{var _curField,_curField2;setRows((_curField=curField)!==null&&_curField!==void 0&&_curField.sortType?sortData(fieldID,rows,(_curField2=curField)===null||_curField2===void 0?void 0:_curField2.sortType):defaultRows);}};/** 鼠标事件 **/var onclickRows=function onclickRows(row,e){clickRows&&clickRows(row,e);};var ondblclickRows=function ondblclickRows(row,e){dblclickRows&&dblclickRows(row,e);};return/*#__PURE__*/_jsx(TableContainer,{component:Paper,className:clsx(className),style:style,children:/*#__PURE__*/_jsxs(Table,{className:classes.table,children:[/*#__PURE__*/_jsx(PLTableHeader,{fields:fields,sortField:sortField,emitSort:emitSort,loading:loading}),/*#__PURE__*/_jsx(TableBody,{children:rows.map(function(row,idx){return/*#__PURE__*/_jsx(TableRow,{onClick:function onClick(e){return onclickRows(row,e);},onDoubleClick:function onDoubleClick(e){return ondblclickRows(row,e);},children:fields.map(function(field){return field.hidden?\"\":/*#__PURE__*/_jsx(TableCell,{align:field.align,children:row[field.value]},\"cell_\".concat(field.value,\"_\").concat(idx));})},idx);})})]})});}","map":{"version":3,"names":["React","useState","makeStyles","Table","TableBody","TableCell","TableContainer","TableRow","Paper","PLTableHeader","cloneDeep","sortBy","clsx","useStyles","table","minWidth","toggleSortString","sortType","undefined","sortData","fieldID","rows","reverse","PLTable","props","classes","sortChange","clickRows","dblclickRows","loading","className","style","fields","setFields","setRows","defaultRows","sortField","setSortField","emitSort","event","curField","forEach","f","value","onclickRows","row","e","ondblclickRows","map","idx","field","hidden","align"],"sources":["/Users/evik/kl/project-2024/klasmart-assessment-frontend/src/components/PLTable/PLTable.tsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Table from \"@material-ui/core/Table\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableContainer from \"@material-ui/core/TableContainer\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport Paper from \"@material-ui/core/Paper\";\n\nimport { PLTableHeader } from \"./PLTableHeader\";\n\nimport { PLField, PLTableProps, PLSortType, PLGridRowData } from \"./PLTableTypes\";\nimport { cloneDeep, sortBy } from \"lodash\";\nimport clsx from \"clsx\";\n\nconst useStyles = makeStyles({\n  table: {\n    minWidth: 650,\n  },\n});\n\n/** 排序 ---- 切换排序方式 **/\nconst toggleSortString = (sortType: PLSortType) => (sortType === undefined ? \"asc\" : sortType === \"asc\" ? \"desc\" : undefined);\nexport const sortData = (fieldID: string, rows: any, sortType: PLSortType) => {\n  return sortType === \"desc\" ? sortBy(rows, [fieldID]).reverse() : sortBy(rows, [fieldID]);\n};\n\nexport function PLTable(props: PLTableProps) {\n  const classes = useStyles();\n  const { sortChange, clickRows, dblclickRows, loading, className, style } = props;\n\n  let [fields, setFields] = useState(props.fields);\n  let [rows, setRows] = useState(props.rows);\n  let defaultRows = cloneDeep(props.rows); /** 默认的数据，用于排序和筛选 **/\n  let [sortField, setSortField] = useState(\"\");\n\n  /** 表头排序事件 **/\n  const emitSort = (fieldID: string, event?: React.MouseEvent<unknown>) => {\n    setSortField(fieldID);\n    let curField: undefined | PLField;\n    fields.forEach((f) => {\n      if (f.value === fieldID) {\n        f.sortType = toggleSortString(f.sortType);\n        curField = f;\n      } else {\n        f.sortType = undefined;\n      }\n    });\n    fields = [...fields];\n    setFields(fields);\n    if (sortChange) sortChange(curField, event);\n    /** 更改排序事件的回调 **/ else {\n      setRows(curField?.sortType ? sortData(fieldID, rows, curField?.sortType) : defaultRows);\n    }\n  };\n\n  /** 鼠标事件 **/\n  const onclickRows = (row: PLGridRowData, e: React.MouseEvent<unknown>) => {\n    clickRows && clickRows(row, e);\n  };\n  const ondblclickRows = (row: PLGridRowData, e: React.MouseEvent<unknown>) => {\n    dblclickRows && dblclickRows(row, e);\n  };\n\n  return (\n    <TableContainer component={Paper} className={clsx(className)} style={style}>\n      <Table className={classes.table}>\n        <PLTableHeader fields={fields} sortField={sortField} emitSort={emitSort} loading={loading} />\n        <TableBody>\n          {rows.map((row, idx) => (\n            <TableRow key={idx} onClick={(e) => onclickRows(row, e)} onDoubleClick={(e) => ondblclickRows(row, e)}>\n              {fields.map((field) =>\n                field.hidden ? (\n                  \"\"\n                ) : (\n                  <TableCell key={`cell_${field.value}_${idx}`} align={field.align}>\n                    {row[field.value]}\n                  </TableCell>\n                )\n              )}\n            </TableRow>\n          ))}\n        </TableBody>\n      </Table>\n    </TableContainer>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}