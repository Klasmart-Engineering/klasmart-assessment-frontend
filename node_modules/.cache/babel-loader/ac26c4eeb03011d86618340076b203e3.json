{"ast":null,"code":"import _defineProperty from\"/Users/evik/kl/project-2024/klasmart-assessment-frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _asyncToGenerator from\"/Users/evik/kl/project-2024/klasmart-assessment-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"/Users/evik/kl/project-2024/klasmart-assessment-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"/Users/evik/kl/project-2024/klasmart-assessment-frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/evik/kl/project-2024/klasmart-assessment-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/evik/kl/project-2024/klasmart-assessment-frontend/node_modules/@babel/runtime/regenerator/index.js\";import useQueryCms from\"@hooks/useQueryCms\";import{unwrapResult}from\"@reduxjs/toolkit\";import{clearNull,toQueryString}from\"@utilities/urlUtilities\";import produce from\"immer\";import{cloneDeep}from\"lodash\";import React,{useEffect,useMemo,useRef,useState}from\"react\";import{useForm}from\"react-hook-form\";import{useDispatch,useSelector}from\"react-redux\";import{useHistory}from\"react-router-dom\";import PermissionType from\"../../api/PermissionType\";import{OutcomeOrderBy,OutcomePublishStatus}from\"../../api/type\";import{FirstSearchHeader,FirstSearchHeaderMb}from\"../../components/AssessmentFirsetHearder/FirstSearchHeader\";import{emptyTip,permissionTip}from\"../../components/TipImages\";import{usePermission}from\"../../hooks/usePermission\";import{d}from\"../../locale/LocaleManager\";import{excluedOutcomeSet,findSetIndex,ids2OutcomeSet,isAllMineOutcome,transferCSVToOutcome}from\"../../models/ModelOutcomeDetailForm\";import{actError,actWarning}from\"../../reducers/notify\";import{approve,bulkApprove,bulkBindOutcomeSet,bulkDeleteOutcome,bulkPublishOutcome,bulkReject,createOutcomeSet,deleteOutcome,exportOutcomes,importLearningOutcomes,newReject,onLoadOutcomeList,parseCsvLo,publishOutcome,pullOutcomeSet,resetSelectedIds,resetUploadData,setSelectedIds}from\"../../reducers/outcome\";import CreateOutcomings from\"../OutcomeEdit\";import{AddSet,useAddSet}from\"./AddSet\";import{LoFields,useLoFields}from\"./LoFields\";import{OutcomeTable}from\"./OutcomeTable\";import{SecondSearchHeader,SecondSearchHeaderMb}from\"./SecondSearchHeader\";import{ThirdSearchHeader,ThirdSearchHeaderMb}from\"./ThirdSearchHeader\";import{BulkListFormKey,LoKeys,OutcomeListExectSearch}from\"./types\";import{UploadOutcome,useUploadOutcome}from\"./UploadOutcome\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useQuery=function useQuery(){var _useQueryCms=useQueryCms(),querys=_useQueryCms.querys,search_key=_useQueryCms.search_key,publish_status=_useQueryCms.publish_status,author_name=_useQueryCms.author_name,page=_useQueryCms.page,is_unpub=_useQueryCms.is_unpub;var order_by=querys.get(\"order_by\")||undefined;var exect_search=querys.get(\"exect_search\")||OutcomeListExectSearch.all;return useMemo(function(){return clearNull({search_key:search_key,publish_status:publish_status,author_name:author_name,page:page,order_by:order_by,is_unpub:is_unpub,exect_search:exect_search});},[search_key,publish_status,author_name,page,order_by,is_unpub,exect_search]);};function useRefreshWithDispatch(){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),refreshKey=_useState2[0],setRefreshKey=_useState2[1];var validRef=useRef(false);var refreshWithDispatch=useMemo(function(){return function(result){return result.then(function(res){setRefreshKey(refreshKey+1);return res;});};},[refreshKey]);useEffect(function(){validRef.current=true;return function(){validRef.current=false;};});return{refreshKey:refreshKey,refreshWithDispatch:refreshWithDispatch};}export function OutcomeList(){var condition=useQuery();var history=useHistory();var dispatch=useDispatch();var _useRefreshWithDispat=useRefreshWithDispatch(),refreshKey=_useRefreshWithDispat.refreshKey,refreshWithDispatch=_useRefreshWithDispat.refreshWithDispatch;var formMethods=useForm();var watch=formMethods.watch,reset=formMethods.reset,getValues=formMethods.getValues;var ids=watch(BulkListFormKey.CHECKED_BULK_IDS);var _useSelector=useSelector(function(state){return state.outcome;}),outcomeList=_useSelector.outcomeList,total=_useSelector.total,user_id=_useSelector.user_id,outcomeSetList=_useSelector.outcomeSetList,defaultSelectOutcomeset=_useSelector.defaultSelectOutcomeset,selectedIdsMap=_useSelector.selectedIdsMap,downloadOutcomes=_useSelector.downloadOutcomes,updateLoList=_useSelector.updateLoList,createLoList=_useSelector.createLoList;var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),headers=_useState4[0],setHeaders=_useState4[1];var selectedIds=useMemo(function(){var currIds=outcomeList.map(function(item){return item.outcome_id;});var idsMap=cloneDeep(selectedIdsMap);currIds.forEach(function(item){idsMap[item]=ids?!!(ids.indexOf(item)>=0):false;});dispatch(setSelectedIds(idsMap));return Object.keys(idsMap).filter(function(item){return idsMap[item];});// eslint-disable-next-line react-hooks/exhaustive-deps\n},[ids,outcomeList,dispatch]);// const [initFields, setInitFields] = useState([\"outcome_name\", \"shortcode\", \"assumed\", \"score_threshold\", \"program\", \"subject\", \"category\", \"subcategory\", \"sets\", \"age\", \"grade\", \"keywords\", \"description\", \"author\", \"updated_at\", \"milestones\"]);\nvar _useState5=useState(_toConsumableArray(LoKeys)),_useState6=_slicedToArray(_useState5,2),initFields=_useState6[0],setInitFields=_useState6[1];var perm=usePermission([PermissionType.view_my_unpublished_learning_outcome_410,PermissionType.view_org_unpublished_learning_outcome_411,PermissionType.view_my_pending_learning_outcome_412,PermissionType.view_org_pending_learning_outcome_413]);var hasPerm=perm.view_my_unpublished_learning_outcome_410||perm.view_org_unpublished_learning_outcome_411||perm.view_my_pending_learning_outcome_412||perm.view_org_pending_learning_outcome_413;var isPending=useMemo(function(){return perm.view_my_unpublished_learning_outcome_410===undefined;},[perm.view_my_unpublished_learning_outcome_410]);var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),showSetList=_React$useState2[0],setShowSetList=_React$useState2[1];var _React$useState3=React.useState([]),_React$useState4=_slicedToArray(_React$useState3,2),selectedOutcomeSet=_React$useState4[0],setSelectedOutcomeSet=_React$useState4[1];var _useAddSet=useAddSet(),addSetActive=_useAddSet.addSetActive,openAddSet=_useAddSet.openAddSet,closeAddSet=_useAddSet.closeAddSet;var _useLoFields=useLoFields(),loFieldsActive=_useLoFields.loFieldsActive,openLoFields=_useLoFields.openLoFields,closeLoFields=_useLoFields.closeLoFields;var _useUploadOutcome=useUploadOutcome(),uploadOutcomeActive=_useUploadOutcome.uploadOutcomeActive,openUploadOutcome=_useUploadOutcome.openUploadOutcome,closeUploadOutcome=_useUploadOutcome.closeUploadOutcome;var handlePublish=function handlePublish(id){dispatch(resetSelectedIds({}));return refreshWithDispatch(dispatch(publishOutcome(id)).then(unwrapResult));};var handleBulkPublish=function handleBulkPublish(){dispatch(resetSelectedIds({}));return refreshWithDispatch(dispatch(bulkPublishOutcome(ids)).then(unwrapResult));};var handleDelete=function handleDelete(id){dispatch(resetSelectedIds({}));return refreshWithDispatch(dispatch(deleteOutcome(id)).then(unwrapResult));};var handleBulkDelete=function handleBulkDelete(){dispatch(resetSelectedIds({}));return refreshWithDispatch(dispatch(bulkDeleteOutcome(ids)).then(unwrapResult));};var handleChangePage=function handleChangePage(page){history.push({search:toQueryString(_objectSpread(_objectSpread({},condition),{},{page:page}))});};var handleClickOutcome=function handleClickOutcome(outcome_id){dispatch(resetSelectedIds({}));history.push({pathname:CreateOutcomings.routeBasePath,search:toQueryString(clearNull({outcome_id:outcome_id,is_unpub:condition.is_unpub}))});};var handleChange=function handleChange(value){dispatch(resetSelectedIds({}));var newValue=produce(value,function(draft){var searchText=getValues()[BulkListFormKey.SEARCH_TEXT_KEY];searchText?draft.search_key=searchText:delete draft.search_key;var exect_search=getValues()[BulkListFormKey.EXECT_SEARCH];draft.exect_search=exect_search;});history.push({search:toQueryString(clearNull(newValue))});};var handleBulkApprove=function handleBulkApprove(){dispatch(resetSelectedIds({}));return refreshWithDispatch(dispatch(bulkApprove(ids)).then(unwrapResult));};var handleBulkReject=function handleBulkReject(){dispatch(resetSelectedIds({}));return refreshWithDispatch(dispatch(bulkReject(ids)).then(unwrapResult));};var handleApprove=function handleApprove(id){dispatch(resetSelectedIds({}));return refreshWithDispatch(dispatch(approve(id)).then(unwrapResult));};var handleReject=function handleReject(id){dispatch(resetSelectedIds({}));return refreshWithDispatch(dispatch(newReject({id:id})).then(unwrapResult));};var handleBulkAddSet=function handleBulkAddSet(){if(!ids||!ids.length)return dispatch(actWarning(d(\"At least one learning outcome should be selected.\").t(\"assess_msg_remove_select_one\")));var isMy=isAllMineOutcome(ids,outcomeList,user_id);if((condition.publish_status===OutcomePublishStatus.draft||condition.publish_status===OutcomePublishStatus.rejected)&&!isMy)return dispatch(actWarning(d(\"You can only do bulk action to your own learning outcomes.\").t(\"assess_msg_set_myonly\")));setSelectedOutcomeSet([]);openAddSet();setShowSetList(false);};var handleClickAddSetConfirmBtn=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var set_ids;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(resetSelectedIds({}));set_ids=selectedOutcomeSet.map(function(item){return item.set_id;});_context.next=4;return refreshWithDispatch(dispatch(bulkBindOutcomeSet({outcome_ids:ids,set_ids:set_ids})).then(unwrapResult));case 4:closeAddSet();case 5:case\"end\":return _context.stop();}}},_callee);}));return function handleClickAddSetConfirmBtn(){return _ref.apply(this,arguments);};}();var handleClickSearchOutcomSet=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(set_name){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(!set_name||!set_name.trim())){_context2.next=3;break;}setShowSetList(false);return _context2.abrupt(\"return\");case 3:_context2.next=5;return dispatch(pullOutcomeSet({set_name:set_name}));case 5:setShowSetList(true);case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function handleClickSearchOutcomSet(_x){return _ref2.apply(this,arguments);};}();var handleClickCreateOutcomeSet=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(set_name){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return dispatch(createOutcomeSet({set_name:set_name}));case 2:return _context3.abrupt(\"return\",_context3.sent);case 3:case\"end\":return _context3.stop();}}},_callee3);}));return function handleClickCreateOutcomeSet(_x2){return _ref3.apply(this,arguments);};}();var handleClickOk=function handleClickOk(ids){var newIds=excluedOutcomeSet(ids,selectedOutcomeSet);var selectedSets=ids2OutcomeSet(newIds,outcomeSetList);var newSets=selectedOutcomeSet.concat(selectedSets);setSelectedOutcomeSet(newSets||[]);setShowSetList(false);};var handleOnInputChange=function handleOnInputChange(){if(showSetList){setShowSetList(false);}};var handleClickDelete=function handleClickDelete(set_id){var index=findSetIndex(set_id,selectedOutcomeSet);var newSets=cloneDeep(selectedOutcomeSet);newSets.splice(index,1);setSelectedOutcomeSet(newSets);};var handleBulkDownloadAll=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var query,_ref5,payload;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:query={is_locked:false,page:1,page_size:50};_context4.next=3;return dispatch(exportOutcomes(_objectSpread(_objectSpread({},query),{},{metaLoading:true})));case 3:_ref5=_context4.sent;payload=_ref5.payload;if(payload){openLoFields();}case 6:case\"end\":return _context4.stop();}}},_callee4);}));return function handleBulkDownloadAll(){return _ref4.apply(this,arguments);};}();var handleOpenFieldsSelected=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var query,_ref7,payload;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(selectedIds.length){_context5.next=2;break;}return _context5.abrupt(\"return\",dispatch(actWarning(d(\"At least one learning outcome should be selected.\").t(\"assess_msg_remove_select_one\"))));case 2:query={outcome_ids:selectedIds,is_locked:false,page:1,page_size:50};_context5.next=5;return dispatch(exportOutcomes(_objectSpread(_objectSpread({},query),{},{metaLoading:true})));case 5:_ref7=_context5.sent;payload=_ref7.payload;if(payload){openLoFields();}case 8:case\"end\":return _context5.stop();}}},_callee5);}));return function handleOpenFieldsSelected(){return _ref6.apply(this,arguments);};}();var handleBulkDownload=function handleBulkDownload(){var _resetBulkListForm;dispatch(resetSelectedIds({}));var resetBulkListForm=(_resetBulkListForm={},_defineProperty(_resetBulkListForm,BulkListFormKey.CHECKED_BULK_IDS,[]),_defineProperty(_resetBulkListForm,BulkListFormKey.SEARCH_TEXT_KEY,condition.search_key),_defineProperty(_resetBulkListForm,BulkListFormKey.EXECT_SEARCH,condition.exect_search),_resetBulkListForm);reset(resetBulkListForm);closeLoFields();return true;};var handleChangeFields=function handleChangeFields(fields){setInitFields(fields);};var handleOpenUpload=function handleOpenUpload(){dispatch(resetUploadData());openUploadOutcome();};var handleUploadSuccess=function handleUploadSuccess(header,array){var loKeyValue={outcome_name:\"Learning Outcome Name\",shortcode:\"Short Code\",//\nassumed:\"Assumed\",score_threshold:\"Score Threshold\",program:\"Program\",subject:\"Subject\",category:\"Category\",subcategory:\"Subcategory\",sets:\"Learning Outcome Set\",//\nage:\"Age\",grade:\"Grade\",keywords:\"Keywords\",description:\"Description\",author:\"Author\",updated_at:\"Created On\",milestones:\"Milestones\"//\n};var templateHeaders=Object.values(loKeyValue);var headAllRight=header.every(function(item,index){return item===templateHeaders[index];});if(headAllRight){if(!array.length||array.length>201){dispatch(resetUploadData());return dispatch(actError(d(\"The CSV file must contain 1~200 learning outcomes! Please check the CSV file and upload again.\").t(\"assessment_lo_bulk_upload_limit\")));}else{var _transferCSVToOutcome=transferCSVToOutcome(header,array),_headers=_transferCSVToOutcome.headers,loArray=_transferCSVToOutcome.loArray;setHeaders(_headers);dispatch(parseCsvLo({loArray:loArray,metaLoading:true}));}}else{dispatch(resetUploadData());return dispatch(actError(d(\"Error in parsing columns! Please use the CSV template file and upload again.\").t(\"assessment_lo_bulk_upload_parse_error\")));}};var handleConfirmUplpadOutcome=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var _ref9,payload;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return dispatch(importLearningOutcomes({metaLoading:true}));case 2:_ref9=_context6.sent;payload=_ref9.payload;if(!payload.exist_error){closeUploadOutcome();history.push({search:toQueryString(_objectSpread(_objectSpread({},condition),{},{publish_status:\"pending\",page:1,is_unpub:\"\"}))});}case 5:case\"end\":return _context6.stop();}}},_callee6);}));return function handleConfirmUplpadOutcome(){return _ref8.apply(this,arguments);};}();useEffect(function(){var page=condition.page;if(outcomeList.length===0&&total&&total>1){page=1;history.push({search:toQueryString(_objectSpread(_objectSpread({},condition),{},{page:page}))});}},[condition,condition.page,history,outcomeList.length,total]);useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){var _initBulkListForm;var selectedIds,initBulkListForm;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return dispatch(onLoadOutcomeList(_objectSpread(_objectSpread({},condition),{},{metaLoading:true})));case 2:selectedIds=Object.keys(selectedIdsMap).filter(function(item){return selectedIdsMap[item];});initBulkListForm=(_initBulkListForm={},_defineProperty(_initBulkListForm,BulkListFormKey.CHECKED_BULK_IDS,selectedIds),_defineProperty(_initBulkListForm,BulkListFormKey.SEARCH_TEXT_KEY,\"\"),_defineProperty(_initBulkListForm,BulkListFormKey.EXECT_SEARCH,OutcomeListExectSearch.all),_initBulkListForm);setTimeout(function(){reset(initBulkListForm);},100);case 5:case\"end\":return _context7.stop();}}},_callee7);}))();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[condition,reset,dispatch,refreshKey]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(FirstSearchHeader,{}),/*#__PURE__*/_jsx(FirstSearchHeaderMb,{}),hasPerm&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(SecondSearchHeader,{formMethods:formMethods,value:condition,onChange:handleChange}),/*#__PURE__*/_jsx(SecondSearchHeaderMb,{formMethods:formMethods,value:condition,onChange:handleChange}),/*#__PURE__*/_jsx(ThirdSearchHeader,{value:condition,selectedIdsLength:selectedIds.length,onChange:handleChange,onBulkPublish:handleBulkPublish,onBulkDelete:handleBulkDelete,onBulkApprove:handleBulkApprove,onBulkReject:handleBulkReject,onBulkAddSet:handleBulkAddSet,onBulkDownloadAll:handleBulkDownloadAll,onBulkDownloadSelected:handleOpenFieldsSelected,onUpload:handleOpenUpload}),/*#__PURE__*/_jsx(ThirdSearchHeaderMb,{value:condition,selectedIdsLength:selectedIds.length,onChange:handleChange,onBulkPublish:handleBulkPublish,onBulkDelete:handleBulkDelete,onBulkApprove:handleBulkApprove,onBulkReject:handleBulkReject,onBulkAddSet:handleBulkAddSet,onBulkDownloadAll:handleBulkDownloadAll,onBulkDownloadSelected:handleOpenFieldsSelected,onUpload:handleOpenUpload})]}),isPending?\"\":hasPerm?total===undefined?\"\":outcomeList&&outcomeList.length>0?/*#__PURE__*/_jsx(OutcomeTable,{formMethods:formMethods,list:outcomeList,total:total,userId:user_id,queryCondition:condition,onChangePage:handleChangePage,onClickOutcome:handleClickOutcome,onPublish:handlePublish,onDelete:handleDelete,onApprove:handleApprove,onReject:handleReject}):emptyTip:permissionTip,/*#__PURE__*/_jsx(AddSet,{open:addSetActive,onClose:closeAddSet,onAddSet:handleClickAddSetConfirmBtn,showSetList:showSetList,onSearchOutcomeSet:handleClickSearchOutcomSet,onCreateOutcomeSet:handleClickCreateOutcomeSet,onSetOutcomeSet:handleClickOk,selectedOutcomeSet:selectedOutcomeSet,outcomeSetList:outcomeSetList,onDeleteSet:handleClickDelete,defaultSelectOutcomeset:defaultSelectOutcomeset,onInputChange:handleOnInputChange}),/*#__PURE__*/_jsx(LoFields,{open:loFieldsActive,list:downloadOutcomes!==null&&downloadOutcomes!==void 0?downloadOutcomes:[],defaultFields:initFields,onClose:closeLoFields,onBulkDownload:handleBulkDownload,onChangeFields:handleChangeFields}),/*#__PURE__*/_jsx(UploadOutcome,{open:uploadOutcomeActive,headers:headers||[],createLoList:createLoList,updateLoList:updateLoList,onClose:closeUploadOutcome,onUploadSuccess:handleUploadSuccess,onConfirm:handleConfirmUplpadOutcome})]});}OutcomeList.routeBasePath=\"/assessments/outcome-list\";OutcomeList.routeRedirectDefault=\"/assessments/outcome-list?publish_status=published&page=1&order_by=\".concat(OutcomeOrderBy._updated_at);","map":{"version":3,"names":["useQueryCms","unwrapResult","clearNull","toQueryString","produce","cloneDeep","React","useEffect","useMemo","useRef","useState","useForm","useDispatch","useSelector","useHistory","PermissionType","OutcomeOrderBy","OutcomePublishStatus","FirstSearchHeader","FirstSearchHeaderMb","emptyTip","permissionTip","usePermission","d","excluedOutcomeSet","findSetIndex","ids2OutcomeSet","isAllMineOutcome","transferCSVToOutcome","actError","actWarning","approve","bulkApprove","bulkBindOutcomeSet","bulkDeleteOutcome","bulkPublishOutcome","bulkReject","createOutcomeSet","deleteOutcome","exportOutcomes","importLearningOutcomes","newReject","onLoadOutcomeList","parseCsvLo","publishOutcome","pullOutcomeSet","resetSelectedIds","resetUploadData","setSelectedIds","CreateOutcomings","AddSet","useAddSet","LoFields","useLoFields","OutcomeTable","SecondSearchHeader","SecondSearchHeaderMb","ThirdSearchHeader","ThirdSearchHeaderMb","BulkListFormKey","LoKeys","OutcomeListExectSearch","UploadOutcome","useUploadOutcome","useQuery","querys","search_key","publish_status","author_name","page","is_unpub","order_by","get","undefined","exect_search","all","useRefreshWithDispatch","refreshKey","setRefreshKey","validRef","refreshWithDispatch","result","then","res","current","OutcomeList","condition","history","dispatch","formMethods","watch","reset","getValues","ids","CHECKED_BULK_IDS","state","outcome","outcomeList","total","user_id","outcomeSetList","defaultSelectOutcomeset","selectedIdsMap","downloadOutcomes","updateLoList","createLoList","headers","setHeaders","selectedIds","currIds","map","item","outcome_id","idsMap","forEach","indexOf","Object","keys","filter","initFields","setInitFields","perm","view_my_unpublished_learning_outcome_410","view_org_unpublished_learning_outcome_411","view_my_pending_learning_outcome_412","view_org_pending_learning_outcome_413","hasPerm","isPending","showSetList","setShowSetList","selectedOutcomeSet","setSelectedOutcomeSet","addSetActive","openAddSet","closeAddSet","loFieldsActive","openLoFields","closeLoFields","uploadOutcomeActive","openUploadOutcome","closeUploadOutcome","handlePublish","id","handleBulkPublish","handleDelete","handleBulkDelete","handleChangePage","push","search","handleClickOutcome","pathname","routeBasePath","handleChange","value","newValue","draft","searchText","SEARCH_TEXT_KEY","EXECT_SEARCH","handleBulkApprove","handleBulkReject","handleApprove","handleReject","handleBulkAddSet","length","t","isMy","rejected","handleClickAddSetConfirmBtn","set_ids","set_id","outcome_ids","handleClickSearchOutcomSet","set_name","trim","handleClickCreateOutcomeSet","handleClickOk","newIds","selectedSets","newSets","concat","handleOnInputChange","handleClickDelete","index","splice","handleBulkDownloadAll","query","is_locked","page_size","metaLoading","payload","handleOpenFieldsSelected","handleBulkDownload","resetBulkListForm","handleChangeFields","fields","handleOpenUpload","handleUploadSuccess","header","array","loKeyValue","outcome_name","shortcode","assumed","score_threshold","program","subject","category","subcategory","sets","age","grade","keywords","description","author","updated_at","milestones","templateHeaders","values","headAllRight","every","loArray","handleConfirmUplpadOutcome","exist_error","initBulkListForm","setTimeout","routeRedirectDefault","_updated_at"],"sources":["/Users/evik/kl/project-2024/klasmart-assessment-frontend/src/pages/OutcomeList/index.tsx"],"sourcesContent":["import { CSVObjProps } from \"@components/UploadCSV\";\nimport useQueryCms from \"@hooks/useQueryCms\";\nimport { AsyncTrunkReturned } from \"@reducers/type\";\nimport { PayloadAction, unwrapResult } from \"@reduxjs/toolkit\";\nimport { clearNull, toQueryString } from \"@utilities/urlUtilities\";\nimport produce from \"immer\";\nimport { cloneDeep } from \"lodash\";\nimport React, { useEffect, useMemo, useRef, useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useHistory } from \"react-router-dom\";\nimport PermissionType from \"../../api/PermissionType\";\nimport { OrderBy, OutcomeOrderBy, OutcomePublishStatus, OutcomeSetResult } from \"../../api/type\";\nimport { FirstSearchHeader, FirstSearchHeaderMb } from \"../../components/AssessmentFirsetHearder/FirstSearchHeader\";\nimport { emptyTip, permissionTip } from \"../../components/TipImages\";\nimport { usePermission } from \"../../hooks/usePermission\";\nimport { d } from \"../../locale/LocaleManager\";\nimport { excluedOutcomeSet, findSetIndex, ids2OutcomeSet, isAllMineOutcome, transferCSVToOutcome } from \"../../models/ModelOutcomeDetailForm\";\nimport { AppDispatch, RootState } from \"../../reducers\";\nimport { actError, actWarning } from \"../../reducers/notify\";\nimport {\n  approve,\n  bulkApprove,\n  bulkBindOutcomeSet,\n  bulkDeleteOutcome,\n  bulkPublishOutcome,\n  bulkReject,\n  createOutcomeSet,\n  deleteOutcome, exportOutcomes, importLearningOutcomes, newReject,\n  onLoadOutcomeList,\n  parseCsvLo,\n  publishOutcome,\n  pullOutcomeSet,\n  resetSelectedIds,\n  resetUploadData,\n  setSelectedIds\n} from \"../../reducers/outcome\";\nimport CreateOutcomings from \"../OutcomeEdit\";\nimport { AddSet, AddSetProps, useAddSet } from \"./AddSet\";\nimport { LoFields, LoFieldsProps, useLoFields } from \"./LoFields\";\nimport { OutcomeTable, OutcomeTableProps } from \"./OutcomeTable\";\nimport { SecondSearchHeader, SecondSearchHeaderMb } from \"./SecondSearchHeader\";\nimport { ThirdSearchHeader, ThirdSearchHeaderMb, ThirdSearchHeaderProps } from \"./ThirdSearchHeader\";\nimport { BulkListForm, BulkListFormKey, LoKeys, OutcomeHeadersProps, OutcomeListExectSearch, OutcomeQueryCondition } from \"./types\";\nimport { UploadOutcome, useUploadOutcome } from \"./UploadOutcome\";\n\nconst useQuery = (): OutcomeQueryCondition => {\n  const { querys, search_key, publish_status, author_name, page, is_unpub } = useQueryCms();\n  const order_by = (querys.get(\"order_by\") as OrderBy | null) || undefined;\n  const exect_search = querys.get(\"exect_search\") || OutcomeListExectSearch.all;\n  return useMemo(() => {\n    return clearNull({ search_key, publish_status, author_name, page, order_by, is_unpub, exect_search });\n  }, [search_key, publish_status, author_name, page, order_by, is_unpub, exect_search]);\n};\ninterface RefreshWithDispatch {\n  <T>(result: Promise<T>): Promise<T>;\n}\n\nfunction useRefreshWithDispatch() {\n  const [refreshKey, setRefreshKey] = useState(0);\n  const validRef = useRef(false);\n  const refreshWithDispatch = useMemo<RefreshWithDispatch>(\n    () => (result) => {\n      return result.then((res) => {\n        setRefreshKey(refreshKey + 1);\n        return res;\n      });\n    },\n    [refreshKey]\n  );\n\n  useEffect(() => {\n    validRef.current = true;\n    return () => {\n      validRef.current = false;\n    };\n  });\n  return { refreshKey, refreshWithDispatch };\n}\n\nexport function OutcomeList() {\n  const condition = useQuery();\n  const history = useHistory();\n  const dispatch = useDispatch<AppDispatch>();\n  const { refreshKey, refreshWithDispatch } = useRefreshWithDispatch();\n  const formMethods = useForm<BulkListForm>();\n  const { watch, reset, getValues } = formMethods;\n  const ids = watch(BulkListFormKey.CHECKED_BULK_IDS);\n  const { outcomeList, total, user_id, outcomeSetList, defaultSelectOutcomeset, selectedIdsMap, downloadOutcomes, updateLoList, createLoList } = useSelector<RootState, RootState[\"outcome\"]>(\n    (state) => state.outcome\n  );\n  const [headers, setHeaders] = useState<OutcomeHeadersProps[]>();\n  const selectedIds = useMemo(() => {\n    const currIds = outcomeList.map(item => item.outcome_id);\n    let idsMap: Record<string, boolean> = cloneDeep(selectedIdsMap);\n    currIds.forEach(item => {\n      idsMap[item!] = ids ? !!(ids.indexOf(item!) >= 0) : false;\n    })\n    dispatch(setSelectedIds(idsMap));\n    return Object.keys(idsMap).filter(item => idsMap[item]);\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [ids, outcomeList, dispatch]);\n  // const [initFields, setInitFields] = useState([\"outcome_name\", \"shortcode\", \"assumed\", \"score_threshold\", \"program\", \"subject\", \"category\", \"subcategory\", \"sets\", \"age\", \"grade\", \"keywords\", \"description\", \"author\", \"updated_at\", \"milestones\"]);\n  const [initFields, setInitFields] = useState([...LoKeys]);\n  const perm = usePermission([\n    PermissionType.view_my_unpublished_learning_outcome_410,\n    PermissionType.view_org_unpublished_learning_outcome_411,\n    PermissionType.view_my_pending_learning_outcome_412,\n    PermissionType.view_org_pending_learning_outcome_413,\n  ]);\n  const hasPerm =\n    perm.view_my_unpublished_learning_outcome_410 ||\n    perm.view_org_unpublished_learning_outcome_411 ||\n    perm.view_my_pending_learning_outcome_412 ||\n    perm.view_org_pending_learning_outcome_413;\n  const isPending = useMemo(\n    () => perm.view_my_unpublished_learning_outcome_410 === undefined,\n    [perm.view_my_unpublished_learning_outcome_410]\n  );\n  const [showSetList, setShowSetList] = React.useState(false);\n  const [selectedOutcomeSet, setSelectedOutcomeSet] = React.useState<OutcomeSetResult>([]);\n  const { addSetActive, openAddSet, closeAddSet } = useAddSet();\n  const { loFieldsActive, openLoFields, closeLoFields } = useLoFields();\n  const { uploadOutcomeActive, openUploadOutcome, closeUploadOutcome } = useUploadOutcome();\n  const handlePublish: OutcomeTableProps[\"onPublish\"] = (id) => {\n    dispatch(resetSelectedIds({}));\n    return refreshWithDispatch(dispatch(publishOutcome(id)).then(unwrapResult));\n  };\n  const handleBulkPublish: ThirdSearchHeaderProps[\"onBulkPublish\"] = () => {\n    dispatch(resetSelectedIds({}));\n    return refreshWithDispatch(dispatch(bulkPublishOutcome(ids)).then(unwrapResult));\n  };\n  const handleDelete: OutcomeTableProps[\"onDelete\"] = (id) => {\n    dispatch(resetSelectedIds({}));\n    return refreshWithDispatch(dispatch(deleteOutcome(id)).then(unwrapResult));\n  };\n  const handleBulkDelete: ThirdSearchHeaderProps[\"onBulkDelete\"] = () => {\n    dispatch(resetSelectedIds({}));\n    return refreshWithDispatch(dispatch(bulkDeleteOutcome(ids)).then(unwrapResult));\n  };\n  const handleChangePage: OutcomeTableProps[\"onChangePage\"] = (page) => {\n    history.push({ search: toQueryString({ ...condition, page }) });\n  }\n  const handleClickOutcome: OutcomeTableProps[\"onClickOutcome\"] = (outcome_id) => {\n    dispatch(resetSelectedIds({}));\n    history.push({\n      pathname: CreateOutcomings.routeBasePath,\n      search: toQueryString(clearNull({ outcome_id, is_unpub: condition.is_unpub })),\n    });\n  }\n  const handleChange: ThirdSearchHeaderProps[\"onChange\"] = (value) => {\n    dispatch(resetSelectedIds({}));\n    const newValue = produce(value, (draft) => {\n      const searchText = getValues()[BulkListFormKey.SEARCH_TEXT_KEY];\n      searchText ? (draft.search_key = searchText) : delete draft.search_key;\n      const exect_search = getValues()[BulkListFormKey.EXECT_SEARCH];\n      draft.exect_search = exect_search;\n    });\n    history.push({ search: toQueryString(clearNull(newValue)) });\n  };\n\n  const handleBulkApprove: ThirdSearchHeaderProps[\"onBulkApprove\"] = () => {\n    dispatch(resetSelectedIds({}));\n    return refreshWithDispatch(dispatch(bulkApprove(ids)).then(unwrapResult));\n  };\n  const handleBulkReject: ThirdSearchHeaderProps[\"onBulkReject\"] = () => {\n    dispatch(resetSelectedIds({}));\n    return refreshWithDispatch(dispatch(bulkReject(ids)).then(unwrapResult));\n  };\n  const handleApprove: OutcomeTableProps[\"onApprove\"] = (id) => {\n    dispatch(resetSelectedIds({}));\n    return refreshWithDispatch(dispatch(approve(id)).then(unwrapResult));\n  };\n  const handleReject: OutcomeTableProps[\"onReject\"] = (id) => {\n    dispatch(resetSelectedIds({}));\n    return refreshWithDispatch(dispatch(newReject({ id: id })).then(unwrapResult));\n  };\n  const handleBulkAddSet: ThirdSearchHeaderProps[\"onBulkAddSet\"] = () => {\n    if (!ids || !ids.length)\n      return dispatch(actWarning(d(\"At least one learning outcome should be selected.\").t(\"assess_msg_remove_select_one\")));\n    const isMy = isAllMineOutcome(ids, outcomeList, user_id);\n    if ((condition.publish_status === OutcomePublishStatus.draft || condition.publish_status === OutcomePublishStatus.rejected) && !isMy)\n      return dispatch(actWarning(d(\"You can only do bulk action to your own learning outcomes.\").t(\"assess_msg_set_myonly\")));\n    setSelectedOutcomeSet([]);\n    openAddSet();\n    setShowSetList(false);\n  };\n  const handleClickAddSetConfirmBtn: AddSetProps[\"onAddSet\"] = async () => {\n    dispatch(resetSelectedIds({}));\n    const set_ids = selectedOutcomeSet.map((item) => item.set_id);\n    await refreshWithDispatch(dispatch(bulkBindOutcomeSet({ outcome_ids: ids, set_ids: set_ids as string[] })).then(unwrapResult));\n    closeAddSet();\n  };\n\n  const handleClickSearchOutcomSet: AddSetProps[\"onSearchOutcomeSet\"] = async (set_name) => {\n    if (!set_name || !set_name.trim()) {\n      setShowSetList(false);\n      return;\n    }\n    await dispatch(pullOutcomeSet({ set_name }));\n    setShowSetList(true);\n  };\n  const handleClickCreateOutcomeSet: AddSetProps[\"onCreateOutcomeSet\"] = async (set_name) => {\n    return await dispatch(createOutcomeSet({ set_name }));\n  };\n  const handleClickOk: AddSetProps[\"onSetOutcomeSet\"] = (ids) => {\n    const newIds = excluedOutcomeSet(ids, selectedOutcomeSet);\n    const selectedSets = ids2OutcomeSet(newIds, outcomeSetList);\n    const newSets = selectedOutcomeSet.concat(selectedSets);\n    setSelectedOutcomeSet(newSets || []);\n    setShowSetList(false);\n  };\n  const handleOnInputChange: AddSetProps[\"onInputChange\"] = () => {\n    if (showSetList) {\n      setShowSetList(false);\n    }\n  };\n  const handleClickDelete: AddSetProps[\"onDeleteSet\"] = (set_id: string) => {\n    const index = findSetIndex(set_id, selectedOutcomeSet);\n    let newSets = cloneDeep(selectedOutcomeSet);\n    newSets.splice(index, 1);\n    setSelectedOutcomeSet(newSets);\n  };\n  const handleBulkDownloadAll: ThirdSearchHeaderProps[\"onBulkDownloadAll\"] = async () => {\n    const query = {\n      is_locked: false, \n      page: 1, \n      page_size: 50\n    }\n    const { payload } = (await dispatch(exportOutcomes({...query, metaLoading: true}))) as unknown as PayloadAction<\n        AsyncTrunkReturned<typeof exportOutcomes>\n      >;\n    if(payload) {\n      openLoFields();\n    }\n  }\n  const handleOpenFieldsSelected: ThirdSearchHeaderProps[\"onBulkDownloadSelected\"] = async () => {\n    if (!selectedIds.length)\n      return dispatch(actWarning(d(\"At least one learning outcome should be selected.\").t(\"assess_msg_remove_select_one\")));\n    const query = {\n      outcome_ids: selectedIds, \n      is_locked: false, \n      page: 1, \n      page_size: 50\n    }\n    const { payload } = (await dispatch(exportOutcomes({...query, metaLoading: true}))) as unknown as PayloadAction<\n        AsyncTrunkReturned<typeof exportOutcomes>\n      >;\n    if(payload) {\n      openLoFields();\n    }\n  }\n  const handleBulkDownload: LoFieldsProps[\"onBulkDownload\"] = () => {\n    dispatch(resetSelectedIds({}));\n    const resetBulkListForm = {\n      [BulkListFormKey.CHECKED_BULK_IDS]: [],\n      [BulkListFormKey.SEARCH_TEXT_KEY]: condition.search_key,\n      [BulkListFormKey.EXECT_SEARCH]: condition.exect_search,\n    }\n    reset(resetBulkListForm);\n    closeLoFields();\n    return true;\n  }\n  const handleChangeFields: LoFieldsProps[\"onChangeFields\"] = (fields: string[]) => {\n    setInitFields(fields)\n  }\n  const handleOpenUpload: ThirdSearchHeaderProps[\"onUpload\"] = () => {\n    dispatch(resetUploadData());\n    openUploadOutcome();\n  }\n  const handleUploadSuccess = (header: string[], array: CSVObjProps[]) => {\n    const loKeyValue = {\n      outcome_name: \"Learning Outcome Name\",\n      shortcode: \"Short Code\",//\n      assumed: \"Assumed\",\n      score_threshold: \"Score Threshold\",\n      program: \"Program\",\n      subject: \"Subject\",\n      category: \"Category\",\n      subcategory: \"Subcategory\",\n      sets: \"Learning Outcome Set\",//\n      age: \"Age\",\n      grade: \"Grade\",\n      keywords: \"Keywords\",\n      description: \"Description\",\n      author: \"Author\",\n      updated_at: \"Created On\",\n      milestones: \"Milestones\",//\n    }\n    const templateHeaders = Object.values(loKeyValue);\n    const headAllRight = header.every((item, index) => item === templateHeaders[index]);\n    if(headAllRight) {\n      if(!array.length || array.length > 201) {\n        dispatch(resetUploadData());\n        return dispatch(actError(d(\"The CSV file must contain 1~200 learning outcomes! Please check the CSV file and upload again.\").t(\"assessment_lo_bulk_upload_limit\")))\n      } else {\n        const { headers, loArray } =  transferCSVToOutcome(header, array);\n        setHeaders(headers);\n        dispatch(parseCsvLo({loArray, metaLoading: true}));\n      }\n    } else {\n      dispatch(resetUploadData());\n      return dispatch(actError(d(\"Error in parsing columns! Please use the CSV template file and upload again.\").t(\"assessment_lo_bulk_upload_parse_error\")))\n    }\n  }\n  const handleConfirmUplpadOutcome = async () => {\n    const { payload } = (await dispatch(importLearningOutcomes({ metaLoading: true }))) as unknown as PayloadAction<\n      AsyncTrunkReturned<typeof importLearningOutcomes>\n    >;\n    if(!payload.exist_error) {\n      closeUploadOutcome();\n      history.push({ search: toQueryString({ ...condition, publish_status: \"pending\", page: 1, is_unpub: \"\" })});\n    }\n  }\n  useEffect(() => {\n    let page = condition.page;\n    if (outcomeList.length === 0 && total && total > 1) {\n      page = 1;\n      history.push({ search: toQueryString({ ...condition, page }) });\n    }\n  }, [condition, condition.page, history, outcomeList.length, total]);\n\n  useEffect(() => {\n    (async () => {\n      await dispatch(onLoadOutcomeList({ ...condition, metaLoading: true }));\n      const selectedIds = Object.keys(selectedIdsMap).filter(item => selectedIdsMap[item]);\n      const initBulkListForm = {\n        [BulkListFormKey.CHECKED_BULK_IDS]: selectedIds,\n        [BulkListFormKey.SEARCH_TEXT_KEY]: \"\",\n        [BulkListFormKey.EXECT_SEARCH]: OutcomeListExectSearch.all,\n      }\n      setTimeout(() => {\n        reset(initBulkListForm);\n      }, 100)\n    })();\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [condition, reset, dispatch, refreshKey]);\n\n  return (\n    <div>\n      <FirstSearchHeader />\n      <FirstSearchHeaderMb />\n      {hasPerm && (\n        <>\n          <SecondSearchHeader formMethods={formMethods} value={condition} onChange={handleChange} />\n          <SecondSearchHeaderMb formMethods={formMethods} value={condition} onChange={handleChange} />\n          <ThirdSearchHeader\n            value={condition}\n            selectedIdsLength={selectedIds.length}\n            onChange={handleChange}\n            onBulkPublish={handleBulkPublish}\n            onBulkDelete={handleBulkDelete}\n            onBulkApprove={handleBulkApprove}\n            onBulkReject={handleBulkReject}\n            onBulkAddSet={handleBulkAddSet}\n            onBulkDownloadAll={handleBulkDownloadAll}\n            onBulkDownloadSelected={handleOpenFieldsSelected}\n            onUpload={handleOpenUpload}\n          />\n          <ThirdSearchHeaderMb\n            value={condition}\n            selectedIdsLength={selectedIds.length}\n            onChange={handleChange}\n            onBulkPublish={handleBulkPublish}\n            onBulkDelete={handleBulkDelete}\n            onBulkApprove={handleBulkApprove}\n            onBulkReject={handleBulkReject}\n            onBulkAddSet={handleBulkAddSet}\n            onBulkDownloadAll={handleBulkDownloadAll}\n            onBulkDownloadSelected={handleOpenFieldsSelected}\n            onUpload={handleOpenUpload}\n          />\n        </>\n      )}\n      {isPending ? (\n        \"\"\n      ) : hasPerm ? (\n        total === undefined ? (\n          \"\"\n        ) : outcomeList && outcomeList.length > 0 ? (\n          <OutcomeTable\n            formMethods={formMethods}\n            list={outcomeList}\n            total={total as number}\n            userId={user_id}\n            queryCondition={condition}\n            onChangePage={handleChangePage}\n            onClickOutcome={handleClickOutcome}\n            onPublish={handlePublish}\n            onDelete={handleDelete}\n            onApprove={handleApprove}\n            onReject={handleReject}\n          />\n        ) : (\n          emptyTip\n        )\n      ) : (\n        permissionTip\n      )}\n      <AddSet\n        open={addSetActive}\n        onClose={closeAddSet}\n        onAddSet={handleClickAddSetConfirmBtn}\n        showSetList={showSetList}\n        onSearchOutcomeSet={handleClickSearchOutcomSet}\n        onCreateOutcomeSet={handleClickCreateOutcomeSet}\n        onSetOutcomeSet={handleClickOk}\n        selectedOutcomeSet={selectedOutcomeSet}\n        outcomeSetList={outcomeSetList}\n        onDeleteSet={handleClickDelete}\n        defaultSelectOutcomeset={defaultSelectOutcomeset}\n        onInputChange={handleOnInputChange}\n      />\n      <LoFields \n        open={loFieldsActive}\n        list={downloadOutcomes ?? []}\n        defaultFields={initFields}\n        onClose={closeLoFields}\n        onBulkDownload={handleBulkDownload}\n        onChangeFields={handleChangeFields}\n      />\n      <UploadOutcome \n        open={uploadOutcomeActive}\n        headers={headers || []}\n        createLoList={createLoList}\n        updateLoList={updateLoList}\n        onClose={closeUploadOutcome}\n        onUploadSuccess={handleUploadSuccess}\n        onConfirm={handleConfirmUplpadOutcome}\n      />\n    </div>\n  );\n}\n\nOutcomeList.routeBasePath = \"/assessments/outcome-list\";\nOutcomeList.routeRedirectDefault = `/assessments/outcome-list?publish_status=published&page=1&order_by=${OutcomeOrderBy._updated_at}`;\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}