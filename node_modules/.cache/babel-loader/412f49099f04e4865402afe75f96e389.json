{"ast":null,"code":"import _asyncToGenerator from\"/Users/evik/kl/project-2024/klasmart-assessment-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/evik/kl/project-2024/klasmart-assessment-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/evik/kl/project-2024/klasmart-assessment-frontend/node_modules/@babel/runtime/regenerator/index.js\";import React,{useEffect}from\"react\";import PermissionType from\"../api/PermissionType\";import permissionCache from\"../services/permissionCahceService\";function usePermission(perms){var _React$useState=React.useState({}),_React$useState2=_slicedToArray(_React$useState,2),state=_React$useState2[0],setState=_React$useState2[1];useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var permsData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return permissionCache.usePermission(perms);case 2:permsData=_context.sent;setState(permsData);case 4:case\"end\":return _context.stop();}}},_callee);}))();return function(){};// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);return state;}/**\n *\n * use this hook to preload some permissions\n *\n */function useLoadPermission(perms){var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),loaded=_React$useState4[0],setLoaded=_React$useState4[1];React.useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return permissionCache.usePermission(perms);case 2:setLoaded(true);case 3:case\"end\":return _context2.stop();}}},_callee2);}))();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);return loaded;}/**\n *  choose some permissions from list\n *  @perms  permissions list, return value from function usePermission\n *  @permsToChoose permissions to choose\n *\n */function useChoosePermission(perms,permsToChoose){return permsToChoose.reduce(function(prev,cur){prev[cur]=perms[cur];return prev;},{});}function useRole(){var perm=usePermission([PermissionType.report_learning_summary_org_652,PermissionType.report_learning_summary_school_651,PermissionType.report_learning_summary_teacher_650,PermissionType.report_learning_summary_student_649,PermissionType.view_completed_assessments_414,PermissionType.view_in_progress_assessments_415,PermissionType.view_org_completed_assessments_424,PermissionType.view_org_in_progress_assessments_425,PermissionType.view_school_completed_assessments_426,PermissionType.view_school_in_progress_assessments_427]);var isOrg=perm.report_learning_summary_org_652;var isSchool=perm.report_learning_summary_school_651;var isTeacher=perm.report_learning_summary_teacher_650;var isStudent=perm.report_learning_summary_student_649;return{isOrg:isOrg,isSchool:isSchool,isTeacher:isTeacher,isStudent:isStudent};}export{usePermission,useLoadPermission,useChoosePermission,useRole};","map":{"version":3,"names":["React","useEffect","PermissionType","permissionCache","usePermission","perms","useState","state","setState","permsData","useLoadPermission","loaded","setLoaded","useChoosePermission","permsToChoose","reduce","prev","cur","useRole","perm","report_learning_summary_org_652","report_learning_summary_school_651","report_learning_summary_teacher_650","report_learning_summary_student_649","view_completed_assessments_414","view_in_progress_assessments_415","view_org_completed_assessments_424","view_org_in_progress_assessments_425","view_school_completed_assessments_426","view_school_in_progress_assessments_427","isOrg","isSchool","isTeacher","isStudent"],"sources":["/Users/evik/kl/project-2024/klasmart-assessment-frontend/src/hooks/usePermission.ts"],"sourcesContent":["import React, { useEffect } from \"react\";\nimport PermissionType from \"../api/PermissionType\";\nimport permissionCache, { ICacheData } from \"../services/permissionCahceService\";\nfunction usePermission(perms: PermissionType[]) {\n  const [state, setState] = React.useState<ICacheData>({});\n  useEffect(() => {\n    (async () => {\n      const permsData = await permissionCache.usePermission(perms);\n      setState(permsData);\n    })();\n    return () => {}\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return state;\n}\n\n/**\n *\n * use this hook to preload some permissions\n *\n */\n\nfunction useLoadPermission(perms: PermissionType[]) {\n  const [loaded, setLoaded] = React.useState<boolean>(false);\n  React.useEffect(() => {\n    (async () => {\n      await permissionCache.usePermission(perms);\n      setLoaded(true);\n    })();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  return loaded;\n}\n/**\n *  choose some permissions from list\n *  @perms  permissions list, return value from function usePermission\n *  @permsToChoose permissions to choose\n *\n */\nfunction useChoosePermission(perms: ICacheData, permsToChoose: PermissionType[]): ICacheData {\n  return permsToChoose.reduce((prev, cur) => {\n    prev[cur] = perms[cur];\n    return prev;\n  }, {} as ICacheData);\n}\n\nfunction useRole() {\n  const perm = usePermission([\n    PermissionType.report_learning_summary_org_652,\n    PermissionType.report_learning_summary_school_651,\n    PermissionType.report_learning_summary_teacher_650,\n    PermissionType.report_learning_summary_student_649,\n    PermissionType.view_completed_assessments_414,\n    PermissionType.view_in_progress_assessments_415,\n    PermissionType.view_org_completed_assessments_424,\n    PermissionType.view_org_in_progress_assessments_425,\n    PermissionType.view_school_completed_assessments_426,\n    PermissionType.view_school_in_progress_assessments_427,\n  ]);\n  const isOrg = perm.report_learning_summary_org_652 as boolean;\n  const isSchool = perm.report_learning_summary_school_651 as boolean;\n  const isTeacher = perm.report_learning_summary_teacher_650 as boolean;\n  const isStudent = perm.report_learning_summary_student_649 as boolean;\n\n  return { isOrg, isSchool, isTeacher, isStudent };\n}\n\nexport { usePermission, useLoadPermission, useChoosePermission, useRole };\n"],"mappings":"6aAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,MAAOC,CAAAA,cAAP,KAA2B,uBAA3B,CACA,MAAOC,CAAAA,eAAP,KAA4C,oCAA5C,CACA,QAASC,CAAAA,aAAT,CAAuBC,KAAvB,CAAgD,CAC9C,oBAA0BL,KAAK,CAACM,QAAN,CAA2B,EAA3B,CAA1B,oDAAOC,KAAP,qBAAcC,QAAd,qBACAP,SAAS,CAAC,UAAM,CACd,wDAAC,uKACyBE,CAAAA,eAAe,CAACC,aAAhB,CAA8BC,KAA9B,CADzB,QACOI,SADP,eAECD,QAAQ,CAACC,SAAD,CAAR,CAFD,sDAAD,KAIA,MAAO,WAAM,CAAE,CAAf,CACA;AACD,CAPQ,CAON,EAPM,CAAT,CASA,MAAOF,CAAAA,KAAP,CACD,CAED;AACA;AACA;AACA;AACA,GAEA,QAASG,CAAAA,iBAAT,CAA2BL,KAA3B,CAAoD,CAClD,qBAA4BL,KAAK,CAACM,QAAN,CAAwB,KAAxB,CAA5B,qDAAOK,MAAP,qBAAeC,SAAf,qBACAZ,KAAK,CAACC,SAAN,CAAgB,UAAM,CACpB,wDAAC,+JACOE,CAAAA,eAAe,CAACC,aAAhB,CAA8BC,KAA9B,CADP,QAECO,SAAS,CAAC,IAAD,CAAT,CAFD,wDAAD,KAIA;AACD,CAND,CAMG,EANH,EAOA,MAAOD,CAAAA,MAAP,CACD,CACD;AACA;AACA;AACA;AACA;AACA,GACA,QAASE,CAAAA,mBAAT,CAA6BR,KAA7B,CAAgDS,aAAhD,CAA6F,CAC3F,MAAOA,CAAAA,aAAa,CAACC,MAAd,CAAqB,SAACC,IAAD,CAAOC,GAAP,CAAe,CACzCD,IAAI,CAACC,GAAD,CAAJ,CAAYZ,KAAK,CAACY,GAAD,CAAjB,CACA,MAAOD,CAAAA,IAAP,CACD,CAHM,CAGJ,EAHI,CAAP,CAID,CAED,QAASE,CAAAA,OAAT,EAAmB,CACjB,GAAMC,CAAAA,IAAI,CAAGf,aAAa,CAAC,CACzBF,cAAc,CAACkB,+BADU,CAEzBlB,cAAc,CAACmB,kCAFU,CAGzBnB,cAAc,CAACoB,mCAHU,CAIzBpB,cAAc,CAACqB,mCAJU,CAKzBrB,cAAc,CAACsB,8BALU,CAMzBtB,cAAc,CAACuB,gCANU,CAOzBvB,cAAc,CAACwB,kCAPU,CAQzBxB,cAAc,CAACyB,oCARU,CASzBzB,cAAc,CAAC0B,qCATU,CAUzB1B,cAAc,CAAC2B,uCAVU,CAAD,CAA1B,CAYA,GAAMC,CAAAA,KAAK,CAAGX,IAAI,CAACC,+BAAnB,CACA,GAAMW,CAAAA,QAAQ,CAAGZ,IAAI,CAACE,kCAAtB,CACA,GAAMW,CAAAA,SAAS,CAAGb,IAAI,CAACG,mCAAvB,CACA,GAAMW,CAAAA,SAAS,CAAGd,IAAI,CAACI,mCAAvB,CAEA,MAAO,CAAEO,KAAK,CAALA,KAAF,CAASC,QAAQ,CAARA,QAAT,CAAmBC,SAAS,CAATA,SAAnB,CAA8BC,SAAS,CAATA,SAA9B,CAAP,CACD,CAED,OAAS7B,aAAT,CAAwBM,iBAAxB,CAA2CG,mBAA3C,CAAgEK,OAAhE"},"metadata":{},"sourceType":"module"}