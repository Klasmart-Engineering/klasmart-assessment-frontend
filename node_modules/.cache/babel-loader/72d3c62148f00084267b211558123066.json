{"ast":null,"code":"import _objectSpread from\"/Users/evik/kl/project-2024/klasmart-assessment-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/evik/kl/project-2024/klasmart-assessment-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectWithoutProperties from\"/Users/evik/kl/project-2024/klasmart-assessment-frontend/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";var _excluded=[\"onClick\",\"children\",\"replace\",\"disabled\"];import{Button,CircularProgress,makeStyles}from\"@material-ui/core\";import React,{useEffect,useMemo,useRef,useState}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles({circle:function circle(props){return{marginRight:props.replace?0:8};}});export function LButton(props){var _props$as;var onClick=props.onClick,children=props.children,replace=props.replace,disabled=props.disabled,restProps=_objectWithoutProperties(props,_excluded);var As=(_props$as=props.as)!==null&&_props$as!==void 0?_props$as:Button;var css=useStyles(restProps);var validRef=useRef(true);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),pending=_useState2[0],setPending=_useState2[1];var handleClick=useMemo(function(){return function(){setPending(true);return onClick.apply(void 0,arguments).then(function(result){validRef.current&&setPending(false);return result;}).catch(function(err){validRef.current&&setPending(false);// throw err;\n});};},[onClick,setPending]);useEffect(function(){validRef.current=true;return function unmount(){validRef.current=false;};});return/*#__PURE__*/_jsxs(As,_objectSpread(_objectSpread({},restProps),{},{onClick:handleClick,disabled:pending||disabled,children:[pending&&/*#__PURE__*/_jsx(CircularProgress,{size:20,className:css.circle}),(!replace||!pending)&&children]}));}","map":{"version":3,"names":["Button","CircularProgress","makeStyles","React","useEffect","useMemo","useRef","useState","useStyles","circle","props","marginRight","replace","LButton","onClick","children","disabled","restProps","As","as","css","validRef","pending","setPending","handleClick","then","result","current","catch","err","unmount"],"sources":["/Users/evik/kl/project-2024/klasmart-assessment-frontend/src/components/LButton/index.tsx"],"sourcesContent":["import { Button, ButtonProps, CircularProgress, makeStyles } from \"@material-ui/core\";\nimport React, { ComponentType, useEffect, useMemo, useRef, useState } from \"react\";\n\nconst useStyles = makeStyles({\n  circle: (props: Partial<LButtonProps>) => ({\n    marginRight: props.replace ? 0 : 8,\n  }),\n});\n\ntype AsProps<TAs> = TAs extends undefined\n  ? ButtonProps\n  : TAs extends React.ComponentType<infer P>\n  ? P\n  : TAs extends keyof JSX.IntrinsicElements\n  ? JSX.IntrinsicElements[TAs]\n  : never;\n\nexport type LButtonProps<TAs extends ComponentType<any> | \"button\" = typeof Button> = Omit<AsProps<TAs>, \"onClick\"> & {\n  onClick: (...args: Parameters<AsProps<TAs>[\"onClick\"]>) => Promise<any>;\n  as?: TAs;\n  replace?: boolean;\n  disabled?: boolean;\n};\n\nexport function LButton<TAs extends ComponentType<any> | \"button\" = typeof Button>(props: LButtonProps<TAs>) {\n  const { onClick, children, replace, disabled, ...restProps } = props;\n  const As = props.as ?? Button;\n  const css = useStyles(restProps);\n  const validRef = useRef<boolean>(true);\n  const [pending, setPending] = useState<boolean>(false);\n  const handleClick = useMemo<AsProps<TAs>[\"onClick\"]>(\n    () =>\n      (...args: Parameters<AsProps<TAs>[\"onClick\"]>) => {\n        setPending(true);\n        return onClick(...args)\n          .then((result) => {\n            validRef.current && setPending(false);\n            return result;\n          })\n          .catch((err) => {\n            validRef.current && setPending(false);\n            // throw err;\n          });\n      },\n    [onClick, setPending]\n  );\n  useEffect(() => {\n    validRef.current = true;\n    return function unmount() {\n      validRef.current = false;\n    };\n  });\n  return (\n    <As {...restProps} onClick={handleClick} disabled={pending || disabled}>\n      {pending && <CircularProgress size={20} className={css.circle} />}\n      {(!replace || !pending) && children}\n    </As>\n  );\n}\n"],"mappings":"ufAAA,OAASA,MAAT,CAA8BC,gBAA9B,CAAgDC,UAAhD,KAAkE,mBAAlE,CACA,MAAOC,CAAAA,KAAP,EAA+BC,SAA/B,CAA0CC,OAA1C,CAAmDC,MAAnD,CAA2DC,QAA3D,KAA2E,OAA3E,C,wFAEA,GAAMC,CAAAA,SAAS,CAAGN,UAAU,CAAC,CAC3BO,MAAM,CAAE,gBAACC,KAAD,QAAmC,CACzCC,WAAW,CAAED,KAAK,CAACE,OAAN,CAAgB,CAAhB,CAAoB,CADQ,CAAnC,EADmB,CAAD,CAA5B,CAqBA,MAAO,SAASC,CAAAA,OAAT,CAA4EH,KAA5E,CAAsG,eAC3G,GAAQI,CAAAA,OAAR,CAA+DJ,KAA/D,CAAQI,OAAR,CAAiBC,QAAjB,CAA+DL,KAA/D,CAAiBK,QAAjB,CAA2BH,OAA3B,CAA+DF,KAA/D,CAA2BE,OAA3B,CAAoCI,QAApC,CAA+DN,KAA/D,CAAoCM,QAApC,CAAiDC,SAAjD,0BAA+DP,KAA/D,YACA,GAAMQ,CAAAA,EAAE,YAAGR,KAAK,CAACS,EAAT,uCAAenB,MAAvB,CACA,GAAMoB,CAAAA,GAAG,CAAGZ,SAAS,CAACS,SAAD,CAArB,CACA,GAAMI,CAAAA,QAAQ,CAAGf,MAAM,CAAU,IAAV,CAAvB,CACA,cAA8BC,QAAQ,CAAU,KAAV,CAAtC,wCAAOe,OAAP,eAAgBC,UAAhB,eACA,GAAMC,CAAAA,WAAW,CAAGnB,OAAO,CACzB,iBACE,WAAkD,CAChDkB,UAAU,CAAC,IAAD,CAAV,CACA,MAAOT,CAAAA,OAAO,MAAP,mBACJW,IADI,CACC,SAACC,MAAD,CAAY,CAChBL,QAAQ,CAACM,OAAT,EAAoBJ,UAAU,CAAC,KAAD,CAA9B,CACA,MAAOG,CAAAA,MAAP,CACD,CAJI,EAKJE,KALI,CAKE,SAACC,GAAD,CAAS,CACdR,QAAQ,CAACM,OAAT,EAAoBJ,UAAU,CAAC,KAAD,CAA9B,CACA;AACD,CARI,CAAP,CASD,CAZH,EADyB,CAczB,CAACT,OAAD,CAAUS,UAAV,CAdyB,CAA3B,CAgBAnB,SAAS,CAAC,UAAM,CACdiB,QAAQ,CAACM,OAAT,CAAmB,IAAnB,CACA,MAAO,SAASG,CAAAA,OAAT,EAAmB,CACxBT,QAAQ,CAACM,OAAT,CAAmB,KAAnB,CACD,CAFD,CAGD,CALQ,CAAT,CAMA,mBACE,MAAC,EAAD,gCAAQV,SAAR,MAAmB,OAAO,CAAEO,WAA5B,CAAyC,QAAQ,CAAEF,OAAO,EAAIN,QAA9D,WACGM,OAAO,eAAI,KAAC,gBAAD,EAAkB,IAAI,CAAE,EAAxB,CAA4B,SAAS,CAAEF,GAAG,CAACX,MAA3C,EADd,CAEG,CAAC,CAACG,OAAD,EAAY,CAACU,OAAd,GAA0BP,QAF7B,IADF,CAMD"},"metadata":{},"sourceType":"module"}