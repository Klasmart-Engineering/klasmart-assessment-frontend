{"ast":null,"code":"import _taggedTemplateLiteral from\"/Users/evik/kl/project-2024/klasmart-assessment-frontend/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";import _objectSpread from\"/Users/evik/kl/project-2024/klasmart-assessment-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/evik/kl/project-2024/klasmart-assessment-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _asyncToGenerator from\"/Users/evik/kl/project-2024/klasmart-assessment-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7;import _regeneratorRuntime from\"/Users/evik/kl/project-2024/klasmart-assessment-frontend/node_modules/@babel/runtime/regenerator/index.js\";import{gql}from\"@apollo/client\";import{store}from\"@reducers/index\";import Cookies from\"js-cookie\";import uniq from\"lodash/uniq\";import api,{gqlapi}from\".\";// import requireContentType from \"../../scripts/contentType.macro\";\nimport{ConnectionDirection}from\"./api-ko-schema.auto\";import{apiEmitter,ApiEvent}from\"./emitter\";// 每个接口都有塞给后端的参数 以及前端 url 上的参数名\nexport var ORG_ID_KEY=\"org_id\";export var LOCALE_KEY=\"locale\";export var PERMISSION_KEY=\"perm\";export var apiGetMockOptions=function apiGetMockOptions(){return fetch(\"https://launch.kidsloop.cn/static/mock-korea-data/select-options.json\").then(function(res){return res.json();});};function getWebsocketApi(){if(!process.env.REACT_APP_KO_BASE_API)return\"\";var url=decodeURIComponent(process.env.REACT_APP_KO_BASE_API);if(!url.includes(\"https\"))return\"\";return url.replace(\"https\",\"wss\");}var DOMAIN=getWebsocketApi();export var apiResourcePathById=function apiResourcePathById(resource_id){if(!resource_id)return;return\"\".concat(process.env.REACT_APP_BASE_DOMAIN,\"/v1/contents_resources/\").concat(resource_id);};export var getPicRealPath=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(resource_id){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return api.contentsResources.getDownloadPath(resource_id);case 2:res=_context.sent;return _context.abrupt(\"return\",res.path);case 4:case\"end\":return _context.stop();}}},_callee);}));return function getPicRealPath(_x){return _ref.apply(this,arguments);};}();export var apiWebSocketValidatePDFById=function apiWebSocketValidatePDFById(source,onChangePercentage){return new Promise(function(resolve,reject){if(!DOMAIN){reject();}var _source$split=source.split(\"-\"),_source$split2=_slicedToArray(_source$split,2),prefix=_source$split2[0],id=_source$split2[1];var ws=new WebSocket(\"\".concat(DOMAIN,\"/pdf/v2/\").concat(prefix,\"/\").concat(id,\"/validate\"));ws.addEventListener(\"open\",/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:ws.send(id);case 1:case\"end\":return _context2.stop();}}},_callee2);})));ws.addEventListener(\"message\",function(messageEvent){var data=JSON.parse(messageEvent.data);var percentage=Math.floor(data.pagesValidated/data.totalPages*100);onChangePercentage===null||onChangePercentage===void 0?void 0:onChangePercentage(percentage);if(data.validationComplete){resolve(data);ws.close();}});ws.addEventListener(\"error\",reject);});};export var apiWebSocketValidatePDF=function apiWebSocketValidatePDF(file,onChangePercentage){return new Promise(function(resolve,reject){if(!DOMAIN){reject();}var ws=new WebSocket(\"\".concat(DOMAIN,\"/pdf/v2/validate\"));ws.binaryType=\"arraybuffer\";ws.addEventListener(\"open\",/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var files,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:files=file;data=files.arrayBuffer();_context3.t0=ws;_context3.next=5;return data;case 5:_context3.t1=_context3.sent;_context3.t0.send.call(_context3.t0,_context3.t1);case 7:case\"end\":return _context3.stop();}}},_callee3);})));ws.addEventListener(\"message\",function(messageEvent){var data=JSON.parse(messageEvent.data);var percentage=Math.floor(data.pagesValidated/data.totalPages*100);onChangePercentage===null||onChangePercentage===void 0?void 0:onChangePercentage(percentage);if(data.validationComplete){resolve(data);ws.close();}});ws.addEventListener(\"error\",reject);});};export var apiGenH5pResourceByToken=function apiGenH5pResourceByToken(token,sub,content_id){// return `${process.env.REACT_APP_H5P_API}/h5p/token/${token}`;\nreturn\"\".concat(process.env.REACT_APP_H5P_API,\"/h5p/action/\").concat(sub,\"/\").concat(content_id,\"?h5ptoken=\").concat(token);};export var apiLivePath=function apiLivePath(token){return\"\".concat(process.env.REACT_APP_LIVE_LINK,\"?token=\").concat(token);};export var apiFetchClassByTeacher=function apiFetchClassByTeacher(mockOptions,teacher_id){if(mockOptions.teacher_class_relationship.length){var class_ids=mockOptions.teacher_class_relationship.filter(function(item){return item.teacher_id===teacher_id;})[0].class_ids;return mockOptions.classes.filter(function(item){return class_ids.filter(function(item1){return item.id===item1;}).length>0;});}};export var apiDownloadPageUrl=function apiDownloadPageUrl(href,fileName){if(!href)return;var _URL=new URL(href),origin=_URL.origin;var downloadUrl=\"\".concat(origin,\"/download.html?download=\").concat(encodeURIComponent(fileName!==null&&fileName!==void 0?fileName:\"\"),\"&href=\").concat(encodeURIComponent(href));return downloadUrl;};export var apiOrganizationOfPage=function apiOrganizationOfPage(){var searchParams=new URLSearchParams(window.location.search);return store.getState().common.organization_id||searchParams.get(ORG_ID_KEY);};export var getDocumentUrl=function getDocumentUrl(router){var _document$location=document.location,origin=_document$location.origin,search=_document$location.search;return\"\".concat(origin,\"/\").concat(search,\"#/\").concat(router);};export var apiWaitForOrganizationOfPage=function apiWaitForOrganizationOfPage(){var errorLabel=\"general_error_no_organization\";// const infoLabel: LangRecordId = \"general_info_waiting_orgnization_info\";\nvar TIME_OUT=3600*1000;// const INFO_INTERVAL = 10 * 1000;\nreturn new Promise(function(resolve,reject){var startTime=Date.now();var orgId=apiOrganizationOfPage();if(orgId)return resolve(orgId);// const infoTimer = setInterval(() => {\n//   apiEmitter.emit<ApiErrorEventData>(ApiEvent.Info, { label: infoLabel });\n// }, INFO_INTERVAL)\nvar timer=setInterval(function(){if(Date.now()-startTime>TIME_OUT){clearInterval(timer);// clearInterval(infoTimer);\napiEmitter.emit(ApiEvent.ResponseError,{label:errorLabel});return reject({label:errorLabel});}var orgId=apiOrganizationOfPage();if(!orgId)return;clearInterval(timer);return resolve(orgId);},100);});};export var recursiveListFolderItems=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(_ref4){var path,partition,item_type,_yield$api$folders$se,rootFolders,resolvePath,forEachFolder,_forEachFolder;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_forEachFolder=function _forEachFolder3(){_forEachFolder=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(folders){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:return _context5.abrupt(\"return\",Promise.all(folders.map(/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(folder){var item_type,dir_path,id,path,_yield$api$folders$se2,items,next;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:item_type=folder.item_type,dir_path=folder.dir_path,id=folder.id;path=resolvePath(dir_path,id);_context4.next=4;return api.folders.searchOrgFolderItems({path:path,item_type:item_type,partition:partition});case 4:_yield$api$folders$se2=_context4.sent;items=_yield$api$folders$se2.items;if(items){_context4.next=8;break;}return _context4.abrupt(\"return\",_objectSpread(_objectSpread({},folder),{},{next:[]}));case 8:_context4.next=10;return forEachFolder(items);case 10:next=_context4.sent;return _context4.abrupt(\"return\",_objectSpread(_objectSpread({},folder),{},{next:next}));case 12:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref6.apply(this,arguments);};}())));case 1:case\"end\":return _context5.stop();}}},_callee5);}));return _forEachFolder.apply(this,arguments);};forEachFolder=function _forEachFolder2(_x3){return _forEachFolder.apply(this,arguments);};resolvePath=function _resolvePath(base,path){if(base.slice(-1)[0]===\"/\")return\"\".concat(base).concat(path);return\"\".concat(base,\"/\").concat(path);};path=_ref4.path,partition=_ref4.partition,item_type=_ref4.item_type;_context6.next=6;return api.folders.searchOrgFolderItems({path:path,item_type:item_type,partition:partition});case 6:_yield$api$folders$se=_context6.sent;rootFolders=_yield$api$folders$se.items;if(rootFolders){_context6.next=10;break;}return _context6.abrupt(\"return\",[]);case 10:return _context6.abrupt(\"return\",forEachFolder(rootFolders));case 11:case\"end\":return _context6.stop();}}},_callee6);}));return function recursiveListFolderItems(_x2){return _ref5.apply(this,arguments);};}();export var apiAddOrganizationToPageUrl=function apiAddOrganizationToPageUrl(id){var url=new URL(window.location.href);url.searchParams.append(ORG_ID_KEY,id);// sessionStorage.clear();\nwindow.history.replaceState(null,document.title,url.toString());};export var apiLocaleInCookie=function apiLocaleInCookie(){var _Cookies$get;return(_Cookies$get=Cookies.get(LOCALE_KEY))===null||_Cookies$get===void 0?void 0:_Cookies$get.slice(0,2);};export var subscribeLocaleInCookie=function subscribeLocaleInCookie(handler){var cache=apiLocaleInCookie();setInterval(function(){var current=apiLocaleInCookie();if(cache===current)return;cache=current;if(current)handler(current);},1000);};export function domainSwitch(){return window.location.host.includes(\"kidsloop.live\");}export function apiIsEnableReport(){return process.env.REACT_APP_ENABLE_REPORT===\"1\";}export function getIsEnableNewGql(){return process.env.REACT_APP_USE_LEGACY_GQL===\"0\";}export var enableNewGql=getIsEnableNewGql();export var enableReviewClass=process.env.REACT_APP_ENABLE_REVIEW_CLASS===\"1\";export function apiSkillsListByIds(_x5){return _apiSkillsListByIds.apply(this,arguments);}function _apiSkillsListByIds(){_apiSkillsListByIds=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(skillIds){var skillsQuery,skillsResult;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:skillsQuery=skillIds.map(function(id,index){return\"\\n    skill\".concat(index,\": subcategoryNode(id: \\\"\").concat(id,\"\\\") {\\n      id\\n      name\\n      status\\n    }\\n    \");}).join(\"\");if(!skillIds.length){_context9.next=7;break;}_context9.next=4;return gqlapi.query({query:gql(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n    query skillsListByIds {\\n      \",\"\\n    } \\n    \"])),skillsQuery)});case 4:_context9.t0=_context9.sent;_context9.next=8;break;case 7:_context9.t0={data:{}};case 8:skillsResult=_context9.t0;return _context9.abrupt(\"return\",skillsResult);case 10:case\"end\":return _context9.stop();}}},_callee9);}));return _apiSkillsListByIds.apply(this,arguments);}export function apiDevelopmentalListIds(_x6){return _apiDevelopmentalListIds.apply(this,arguments);}function _apiDevelopmentalListIds(){_apiDevelopmentalListIds=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(developmental){var developmentalQuery,developmentalResult;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:developmentalQuery=developmental.map(function(id,index){return\"\\n    developmental\".concat(index,\": categoryNode(id: \\\"\").concat(id,\"\\\") {\\n      id\\n      name\\n      status\\n    }\\n    \");}).join(\"\");if(!developmental.length){_context10.next=7;break;}_context10.next=4;return gqlapi.query({query:gql(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n    query developmentalListByIds {\\n      \",\"\\n    } \\n    \"])),developmentalQuery)});case 4:_context10.t0=_context10.sent;_context10.next=8;break;case 7:_context10.t0={data:{}};case 8:developmentalResult=_context10.t0;return _context10.abrupt(\"return\",developmentalResult);case 10:case\"end\":return _context10.stop();}}},_callee10);}));return _apiDevelopmentalListIds.apply(this,arguments);}export function apiGetPartPermission(_x7){return _apiGetPartPermission.apply(this,arguments);}function _apiGetPartPermission(){_apiGetPartPermission=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11(permissions){var organization_id,permissionIds,fragmentStr;return _regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.next=2;return apiWaitForOrganizationOfPage();case 2:_context11.t0=_context11.sent;if(_context11.t0){_context11.next=5;break;}_context11.t0=\"\";case 5:organization_id=_context11.t0;if(!enableNewGql){_context11.next=13;break;}permissionIds=uniq(permissions).map(function(item){return\"\\\"\".concat(item,\"\\\"\");}).join(\",\");_context11.next=10;return gqlapi.query({query:gql(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n        query{\\n          myUser{\\n            hasPermissionsInOrganization(\\n              organizationId: \\\"\",\"\\\",\\n              permissionIds: [\\n                \",\"\\n              ]\\n            ){\\n              permissionId\\n              allowed\\n            }\\n          }\\n        }\\n      \"])),organization_id,permissionIds)}).then(function(resp){var _resp$data,_resp$data$myUser,_resp$data2,_resp$data2$myUser;return{error:(resp.errors||[]).length>0||((_resp$data=resp.data)===null||_resp$data===void 0?void 0:(_resp$data$myUser=_resp$data.myUser)===null||_resp$data$myUser===void 0?void 0:_resp$data$myUser.hasPermissionsInOrganization)===null,data:(((_resp$data2=resp.data)===null||_resp$data2===void 0?void 0:(_resp$data2$myUser=_resp$data2.myUser)===null||_resp$data2$myUser===void 0?void 0:_resp$data2$myUser.hasPermissionsInOrganization)||[]).reduce(function(prev,cur){prev[cur.permissionId]=cur.allowed;return prev;},{})};});case 10:return _context11.abrupt(\"return\",_context11.sent);case 13:fragmentStr=permissions.map(function(permission){return\"\".concat(permission,\": checkAllowed(permission_name: \\\"\").concat(permission,\"\\\")\");}).join(\",\");_context11.next=16;return gqlapi.query({query:gql(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n      query{\\n        meMembership: me{\\n          membership(organization_id: \\\"\",\"\\\"){\\n            \",\"\\n          }\\n        }\\n      }\\n    \"])),organization_id,fragmentStr)}).then(function(resp){var _resp$data3,_resp$data3$meMembers,_resp$data4,_resp$data4$meMembers;return{error:(resp.errors||[]).length>0||((_resp$data3=resp.data)===null||_resp$data3===void 0?void 0:(_resp$data3$meMembers=_resp$data3.meMembership)===null||_resp$data3$meMembers===void 0?void 0:_resp$data3$meMembers.membership)===null,data:((_resp$data4=resp.data)===null||_resp$data4===void 0?void 0:(_resp$data4$meMembers=_resp$data4.meMembership)===null||_resp$data4$meMembers===void 0?void 0:_resp$data4$meMembers.membership)||{}};});case 16:return _context11.abrupt(\"return\",_context11.sent);case 17:case\"end\":return _context11.stop();}}},_callee11);}));return _apiGetPartPermission.apply(this,arguments);}var idToNameMap=new Map();export function apiGetUserNameByUserId(_x8){return _apiGetUserNameByUserId.apply(this,arguments);}function _apiGetUserNameByUserId(){_apiGetUserNameByUserId=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee12(userIds){var fragmentStr,userQuery,item,user;return _regeneratorRuntime.wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:fragmentStr=userIds.filter(function(id){return!idToNameMap.has(id);}).map(function(userId,index){return enableNewGql?\"\\n          user_\".concat(index,\": userNode(id: \\\"\").concat(userId,\"\\\"){\\n            id,\\n            givenName \\n            familyName\\n          }\\n        \"):\"\\n          user_\".concat(index,\": user(user_id: \\\"\").concat(userId,\"\\\"){\\n            user_id,\\n            given_name\\n            family_name\\n          }\\n        \");}).join(\",\");if(fragmentStr){_context12.next=3;break;}return _context12.abrupt(\"return\",idToNameMap);case 3:_context12.prev=3;_context12.next=6;return gqlapi.query({query:gql(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n        query userNameByUserIdQuery{\\n          \",\"\\n        },\\n        \\n      \"])),fragmentStr)});case 6:userQuery=_context12.sent;for(item in userQuery.data||{}){user=userQuery.data[item];if(user){enableNewGql?idToNameMap.set(user.id,\"\".concat(user.givenName,\" \").concat(user.familyName)):idToNameMap.set(user.user_id,\"\".concat(user.given_name,\" \").concat(user.family_name));}}_context12.next=12;break;case 10:_context12.prev=10;_context12.t0=_context12[\"catch\"](3);case 12:return _context12.abrupt(\"return\",idToNameMap);case 13:case\"end\":return _context12.stop();}}},_callee12,null,[[3,10]]);}));return _apiGetUserNameByUserId.apply(this,arguments);}export function getUserIdAndOrgId(){return _getUserIdAndOrgId.apply(this,arguments);}function _getUserIdAndOrgId(){_getUserIdAndOrgId=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee13(){var organizationId;return _regeneratorRuntime.wrap(function _callee13$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:_context13.next=2;return apiWaitForOrganizationOfPage();case 2:_context13.t0=_context13.sent;if(_context13.t0){_context13.next=5;break;}_context13.t0=\"\";case 5:organizationId=_context13.t0;return _context13.abrupt(\"return\",organizationId);case 7:case\"end\":return _context13.stop();}}},_callee13);}));return _getUserIdAndOrgId.apply(this,arguments);}export var refreshToken=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){var resp;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return fetch(\"\".concat(process.env.REACT_APP_AUTH_API,\"/refresh\"),{credentials:\"include\"}).then(function(resp){return resp.json();}).then(function(data){return data;});case 2:resp=_context7.sent;return _context7.abrupt(\"return\",resp);case 4:case\"end\":return _context7.stop();}}},_callee7);}));return function refreshToken(){return _ref7.apply(this,arguments);};}();export var uploadFile=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(path,body){var resp;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return fetch(path,{method:\"PUT\",body:body}).then(function(resp){return resp.json;});case 2:resp=_context8.sent;return _context8.abrupt(\"return\",resp);case 4:case\"end\":return _context8.stop();}}},_callee8);}));return function uploadFile(_x9,_x10){return _ref8.apply(this,arguments);};}();export function getProgramIdByProgramName(_x11){return _getProgramIdByProgramName.apply(this,arguments);}function _getProgramIdByProgramName(){_getProgramIdByProgramName=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee14(names){var nameToProgramArray,orgId,queryStr,programResult,item,program;return _regeneratorRuntime.wrap(function _callee14$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:nameToProgramArray=[];if(!(names.length===0)){_context14.next=3;break;}return _context14.abrupt(\"return\",nameToProgramArray);case 3:orgId=apiOrganizationOfPage();queryStr=names.map(function(name,index){var filter=\"{\\n      AND: [\\n        {\\n          OR: [\\n            {organizationId: {\\n              operator: eq,\\n              value: \\\"\".concat(orgId,\"\\\"\\n            }},\\n            {system: {operator: eq, value: true}}\\n          ]\\n        },\\n        {name: {\\n            operator: eq,\\n            value: \\\"\").concat(name,\"\\\",\\n            caseInsensitive: false\\n        }},\\n        {status: {\\n          operator: eq, \\n          value: \\\"active\\\"\\n        }}\\n      ]\\n    }\");return\"q_\".concat(index,\": programsConnection(filter: \").concat(filter,\", direction: \").concat(ConnectionDirection.Forward,\"){\\n      edges{\\n        node{\\n          id,\\n          name,\\n          ageRangesConnection {\\n            edges {\\n              node {\\n                id\\n                name\\n                status\\n                system\\n              }\\n            }\\n          },\\n          gradesConnection {\\n            edges {\\n              node {\\n                id\\n                name\\n                status\\n                system\\n              }\\n            }\\n          }\\n        }\\n      }\\n    }\");}).join(\",\");_context14.prev=5;_context14.next=8;return gqlapi.query({query:gql(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n      query getProgramIdByName{\\n        \",\"\\n      }\\n      \"])),queryStr)});case 8:programResult=_context14.sent;for(item in programResult.data||{}){program=programResult.data[item];if(program&&program.edges.length>=1){program.edges.forEach(function(pItem,index){if(index===0){var age=pItem.node.ageRangesConnection;var grade=pItem.node.gradesConnection;nameToProgramArray.push({id:pItem.node.id,name:pItem.node.name,ages:age.edges.map(function(aItem){return{id:aItem.node.id,name:aItem.node.name,system:aItem.node.system,status:aItem.node.status};}),grades:grade.edges.map(function(gItem){return{id:gItem.node.id,name:gItem.node.name,system:gItem.node.system,status:gItem.node.status};})});}});}}_context14.next=14;break;case 12:_context14.prev=12;_context14.t0=_context14[\"catch\"](5);case 14:return _context14.abrupt(\"return\",nameToProgramArray);case 15:case\"end\":return _context14.stop();}}},_callee14,null,[[5,12]]);}));return _getProgramIdByProgramName.apply(this,arguments);}export function getSubjectIdByProgramIdAndSubjectName(_x12,_x13){return _getSubjectIdByProgramIdAndSubjectName.apply(this,arguments);}function _getSubjectIdByProgramIdAndSubjectName(){_getSubjectIdByProgramIdAndSubjectName=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee15(programId,subjectNames){var orgId,nameToSubjectArray,queryStr,subjectResult,item,subject;return _regeneratorRuntime.wrap(function _callee15$(_context15){while(1){switch(_context15.prev=_context15.next){case 0:orgId=apiOrganizationOfPage();nameToSubjectArray=[];queryStr=subjectNames.map(function(name,index){var filterStr=\"{\\n      AND: [\\n        {\\n          OR: [\\n            {\\n              organizationId: {\\n                operator: eq,\\n                value: \\\"\".concat(orgId,\"\\\"\\n              }\\n            },\\n            {\\n              system: {\\n                operator: eq, \\n                value: true\\n              }\\n            }\\n          ],\\n          AND: [{\\n              name: {\\n                operator: contains, \\n                value: \\\"\").concat(name,\"\\\", \\n                caseInsensitive: true\\n              },\\n              programId: {\\n                operator: eq,\\n                value: \\\"\").concat(programId,\"\\\"\\n              }\\n          }]\\n        }\\n      ],\\n      status: {operator: eq, value: \\\"active\\\"}\\n    }\");return\"q_\".concat(index,\": subjectsConnection(filter: \").concat(filterStr,\", direction: \").concat(ConnectionDirection.Forward,\"){\\n      edges {\\n        node {\\n          id,\\n          name,\\n          status,\\n          system,\\n          categoriesConnection{\\n            edges{\\n              node {\\n                 id,\\n         \\t\\t\\t\\t name,\\n                system,\\n                status,\\n                subcategoriesConnection{\\n                  edges{\\n                    node {\\n                       id,\\n                        name,\\n                      system,\\n                      status,\\n                    }\\n                  }\\n                }\\n              }\\n            }\\n          }\\n        }\\n      }\\n    }\");}).join(\",\");_context15.prev=3;_context15.next=6;return gqlapi.query({query:gql(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"\\n        query getSubjectIdByName{\",\"}\\n      \"])),queryStr)});case 6:subjectResult=_context15.sent;for(item in subjectResult.data||{}){subject=subjectResult.data[item];if(subject&&subject.edges.length>=1){subject.edges.forEach(function(sItem,index){if(index===0){var category=sItem.node.categoriesConnection;nameToSubjectArray.push({id:sItem.node.id,name:sItem.node.name,category:category.edges.map(function(cItem){if(cItem){var subcategory=cItem.node.subcategoriesConnection;return{id:cItem.node.id,name:cItem.node.name,system:cItem.node.system,status:cItem.node.status,subCategory:subcategory.edges.map(function(scItem){return{id:scItem.node.id,name:scItem.node.name,system:scItem.node.system,status:scItem.node.status};})};}else{return undefined;}})});}});}}_context15.next=12;break;case 10:_context15.prev=10;_context15.t0=_context15[\"catch\"](3);case 12:return _context15.abrupt(\"return\",nameToSubjectArray);case 13:case\"end\":return _context15.stop();}}},_callee15,null,[[3,10]]);}));return _getSubjectIdByProgramIdAndSubjectName.apply(this,arguments);}export function getGradeIdByProgramIdAndGradeName(_x14,_x15){return _getGradeIdByProgramIdAndGradeName.apply(this,arguments);}function _getGradeIdByProgramIdAndGradeName(){_getGradeIdByProgramIdAndGradeName=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee16(programId,gradeNames){return _regeneratorRuntime.wrap(function _callee16$(_context16){while(1){switch(_context16.prev=_context16.next){case 0:case\"end\":return _context16.stop();}}},_callee16);}));return _getGradeIdByProgramIdAndGradeName.apply(this,arguments);}export function isEnableUpload(){return process.env.REACT_APP_ENABLE_UPLOAD_LO===\"1\";}","map":{"version":3,"names":["gql","store","Cookies","uniq","api","gqlapi","ConnectionDirection","apiEmitter","ApiEvent","ORG_ID_KEY","LOCALE_KEY","PERMISSION_KEY","apiGetMockOptions","fetch","then","res","json","getWebsocketApi","process","env","REACT_APP_KO_BASE_API","url","decodeURIComponent","includes","replace","DOMAIN","apiResourcePathById","resource_id","REACT_APP_BASE_DOMAIN","getPicRealPath","contentsResources","getDownloadPath","path","apiWebSocketValidatePDFById","source","onChangePercentage","Promise","resolve","reject","split","prefix","id","ws","WebSocket","addEventListener","send","messageEvent","data","JSON","parse","percentage","Math","floor","pagesValidated","totalPages","validationComplete","close","apiWebSocketValidatePDF","file","binaryType","files","arrayBuffer","apiGenH5pResourceByToken","token","sub","content_id","REACT_APP_H5P_API","apiLivePath","REACT_APP_LIVE_LINK","apiFetchClassByTeacher","mockOptions","teacher_id","teacher_class_relationship","length","class_ids","filter","item","classes","item1","apiDownloadPageUrl","href","fileName","URL","origin","downloadUrl","encodeURIComponent","apiOrganizationOfPage","searchParams","URLSearchParams","window","location","search","getState","common","organization_id","get","getDocumentUrl","router","document","apiWaitForOrganizationOfPage","errorLabel","TIME_OUT","startTime","Date","now","orgId","timer","setInterval","clearInterval","emit","ResponseError","label","recursiveListFolderItems","resolvePath","forEachFolder","folders","all","map","folder","item_type","dir_path","searchOrgFolderItems","partition","items","next","base","slice","rootFolders","apiAddOrganizationToPageUrl","append","history","replaceState","title","toString","apiLocaleInCookie","subscribeLocaleInCookie","handler","cache","current","domainSwitch","host","apiIsEnableReport","REACT_APP_ENABLE_REPORT","getIsEnableNewGql","REACT_APP_USE_LEGACY_GQL","enableNewGql","enableReviewClass","REACT_APP_ENABLE_REVIEW_CLASS","apiSkillsListByIds","skillIds","skillsQuery","index","join","query","skillsResult","apiDevelopmentalListIds","developmental","developmentalQuery","developmentalResult","apiGetPartPermission","permissions","permissionIds","resp","error","errors","myUser","hasPermissionsInOrganization","reduce","prev","cur","permissionId","allowed","fragmentStr","permission","meMembership","membership","idToNameMap","Map","apiGetUserNameByUserId","userIds","has","userId","userQuery","user","set","givenName","familyName","user_id","given_name","family_name","getUserIdAndOrgId","organizationId","refreshToken","REACT_APP_AUTH_API","credentials","uploadFile","body","method","getProgramIdByProgramName","names","nameToProgramArray","queryStr","name","Forward","programResult","program","edges","forEach","pItem","age","node","ageRangesConnection","grade","gradesConnection","push","ages","aItem","system","status","grades","gItem","getSubjectIdByProgramIdAndSubjectName","programId","subjectNames","nameToSubjectArray","filterStr","subjectResult","subject","sItem","category","categoriesConnection","cItem","subcategory","subcategoriesConnection","subCategory","scItem","undefined","getGradeIdByProgramIdAndGradeName","gradeNames","isEnableUpload","REACT_APP_ENABLE_UPLOAD_LO"],"sources":["/Users/evik/kl/project-2024/klasmart-assessment-frontend/src/api/extra.ts"],"sourcesContent":["import { gql } from \"@apollo/client\";\nimport { ProgramsObjProps, SubjectObjProps } from \"@pages/OutcomeList/types\";\nimport { LinkedMockOptionsItem } from \"@reducers/contentEdit/programsHandler\";\nimport { store } from \"@reducers/index\";\nimport { FileLike } from \"@rpldy/shared\";\nimport Cookies from \"js-cookie\";\nimport uniq from \"lodash/uniq\";\nimport api, { gqlapi } from \".\";\n// import requireContentType from \"../../scripts/contentType.macro\";\nimport { LangRecordId } from \"../locale/lang/type\";\nimport { ICacheData } from \"../services/permissionCahceService\";\nimport { ConnectionDirection } from \"./api-ko-schema.auto\";\nimport { EntityFolderItemInfo } from \"./api.auto\";\nimport { apiEmitter, ApiErrorEventData, ApiEvent } from \"./emitter\";\n\n// 每个接口都有塞给后端的参数 以及前端 url 上的参数名\nexport const ORG_ID_KEY = \"org_id\";\nexport const LOCALE_KEY = \"locale\";\nexport const PERMISSION_KEY = \"perm\";\n\nexport const apiGetMockOptions = () =>\n  fetch(\"https://launch.kidsloop.cn/static/mock-korea-data/select-options.json\").then((res) => {\n    return res.json();\n  });\nexport interface MockOptionsItem {\n  id?: string;\n  name?: string;\n}\n\nexport interface MockOptionsItemTeacherAndClass {\n  teacher_id: string;\n  class_ids: string[];\n}\n\nexport interface MockOptionsOptionsDevelopmentalItem extends MockOptionsItem {\n  skills: MockOptionsItem[];\n}\n\nexport interface MockOptionsOptionsItem {\n  program: MockOptionsItem;\n  subject: MockOptionsItem[];\n  developmental: MockOptionsOptionsDevelopmentalItem[];\n  age: MockOptionsItem[];\n  grade: MockOptionsItem[];\n}\n\nexport interface MockOptions {\n  options: MockOptionsOptionsItem[];\n  visibility_settings: MockOptionsItem[];\n  lesson_types: MockOptionsItem[];\n  classes: MockOptionsItem[];\n  class_types: MockOptionsItem[];\n  organizations: MockOptionsItem[];\n  teachers: MockOptionsItem[];\n  students: MockOptionsItem[];\n  users: MockOptionsItem[];\n  teacher_class_relationship: MockOptionsItemTeacherAndClass[];\n}\nexport interface ValidationStatus {\n  key: string;\n  validationComplete: boolean;\n  valid?: boolean; // undefined when still validating\n  totalPages?: number; // undefined when the PDF document is completely invalid or corrupted and no page data is available\n  pagesValidated?: number; // undefined when totalPages is undefined\n}\n\nfunction getWebsocketApi() {\n  if (!process.env.REACT_APP_KO_BASE_API) return \"\";\n  const url = decodeURIComponent(process.env.REACT_APP_KO_BASE_API);\n  if (!url.includes(\"https\")) return \"\";\n  return url.replace(\"https\", \"wss\");\n}\nconst DOMAIN = getWebsocketApi();\n\nexport const apiResourcePathById = (resource_id?: string) => {\n  if (!resource_id) return;\n  return `${process.env.REACT_APP_BASE_DOMAIN}/v1/contents_resources/${resource_id}`;\n};\n\nexport const getPicRealPath = async (resource_id?: string) => {\n  const res = await api.contentsResources.getDownloadPath(resource_id as string)\n  return res.path;\n}\n\nexport const apiWebSocketValidatePDFById = (source: string, onChangePercentage?: (percentage: number) => any) => {\n  return new Promise((resolve: (data: ValidationStatus) => any, reject: () => any) => {\n    if (!DOMAIN) {\n      reject();\n    }\n    const [prefix, id] = source.split(\"-\");\n    const ws = new WebSocket(`${DOMAIN}/pdf/v2/${prefix}/${id}/validate`);\n    ws.addEventListener(\"open\", async () => {\n      ws.send(id);\n    });\n    ws.addEventListener(\"message\", (messageEvent) => {\n      const data = JSON.parse(messageEvent.data);\n      const percentage = Math.floor((data.pagesValidated / data.totalPages) * 100);\n      onChangePercentage?.(percentage);\n      if (data.validationComplete) {\n        resolve(data);\n        ws.close();\n      }\n    });\n    ws.addEventListener(\"error\", reject);\n  });\n};\nexport const apiWebSocketValidatePDF = (file: FileLike, onChangePercentage?: (percentage: number) => any) => {\n  return new Promise((resolve: (data: ValidationStatus) => any, reject: () => any) => {\n    if (!DOMAIN) {\n      reject();\n    }\n    const ws = new WebSocket(`${DOMAIN}/pdf/v2/validate`);\n    ws.binaryType = \"arraybuffer\";\n    ws.addEventListener(\"open\", async () => {\n      const files = file as unknown as Blob;\n      const data = files.arrayBuffer();\n      ws.send(await data);\n    });\n    ws.addEventListener(\"message\", (messageEvent) => {\n      const data = JSON.parse(messageEvent.data);\n      const percentage = Math.floor((data.pagesValidated / data.totalPages) * 100);\n      onChangePercentage?.(percentage);\n      if (data.validationComplete) {\n        resolve(data);\n        ws.close();\n      }\n    });\n    ws.addEventListener(\"error\", reject);\n  });\n};\n\nexport const apiGenH5pResourceByToken = (token: string, sub: string, content_id?: string) => {\n  // return `${process.env.REACT_APP_H5P_API}/h5p/token/${token}`;\n  return `${process.env.REACT_APP_H5P_API}/h5p/action/${sub}/${content_id}?h5ptoken=${token}`;\n};\n\nexport const apiLivePath = (token: string) => {\n  return `${process.env.REACT_APP_LIVE_LINK}?token=${token}`;\n};\n\nexport const apiFetchClassByTeacher = (mockOptions: MockOptions, teacher_id: string) => {\n  if (mockOptions.teacher_class_relationship.length) {\n    const class_ids = mockOptions.teacher_class_relationship.filter(\n      (item: MockOptionsItemTeacherAndClass) => item.teacher_id === teacher_id\n    )[0].class_ids;\n    return mockOptions.classes.filter((item: MockOptionsItem) => class_ids.filter((item1: string) => item.id === item1).length > 0);\n  }\n};\n\nexport const apiDownloadPageUrl = (href?: string, fileName?: string) => {\n  if (!href) return;\n  const { origin } = new URL(href);\n  const downloadUrl = `${origin}/download.html?download=${encodeURIComponent(fileName ?? \"\")}&href=${encodeURIComponent(href)}`;\n  return downloadUrl;\n};\n\nexport const apiOrganizationOfPage = () => {\n  const searchParams = new URLSearchParams(window.location.search);\n  return store.getState().common.organization_id || searchParams.get(ORG_ID_KEY);\n};\n\nexport const getDocumentUrl = (router: string) => {\n  const { origin, search } = document.location;\n  return `${origin}/${search}#/${router}`;\n};\n\nexport const apiWaitForOrganizationOfPage = (): Promise<string> => {\n  const errorLabel: LangRecordId = \"general_error_no_organization\";\n  // const infoLabel: LangRecordId = \"general_info_waiting_orgnization_info\";\n  const TIME_OUT = 3600 * 1000;\n  // const INFO_INTERVAL = 10 * 1000;\n  return new Promise((resolve, reject) => {\n    const startTime = Date.now();\n    const orgId = apiOrganizationOfPage();\n    if (orgId) return resolve(orgId);\n    // const infoTimer = setInterval(() => {\n    //   apiEmitter.emit<ApiErrorEventData>(ApiEvent.Info, { label: infoLabel });\n    // }, INFO_INTERVAL)\n    const timer = setInterval(() => {\n      if (Date.now() - startTime > TIME_OUT) {\n        clearInterval(timer);\n        // clearInterval(infoTimer);\n        apiEmitter.emit<ApiErrorEventData>(ApiEvent.ResponseError, { label: errorLabel });\n        return reject({ label: errorLabel });\n      }\n      const orgId = apiOrganizationOfPage();\n      if (!orgId) return;\n      clearInterval(timer);\n      return resolve(orgId);\n    }, 100);\n  });\n};\n\ntype recursiveListFolderItemsProps = NonNullable<Parameters<typeof api.folders.searchOrgFolderItems>[0]>;\nexport interface RecursiveFolderItem extends EntityFolderItemInfo {\n  next: RecursiveFolderItem[];\n}\nexport const recursiveListFolderItems = async ({\n  path,\n  partition,\n  item_type,\n}: recursiveListFolderItemsProps): Promise<RecursiveFolderItem[]> => {\n  const { items: rootFolders } = await api.folders.searchOrgFolderItems({ path, item_type, partition });\n  if (!rootFolders) return [];\n  function resolvePath(base: string, path: string): string {\n    if (base.slice(-1)[0] === \"/\") return `${base}${path}`;\n    return `${base}/${path}`;\n  }\n  async function forEachFolder(folders: EntityFolderItemInfo[]): Promise<RecursiveFolderItem[]> {\n    return Promise.all(\n      folders.map(async (folder) => {\n        const { item_type, dir_path, id } = folder;\n        const path = resolvePath(dir_path as string, id as string);\n        const { items } = await api.folders.searchOrgFolderItems({ path, item_type, partition });\n        if (!items) return { ...folder, next: [] };\n        const next = await forEachFolder(items);\n        return { ...folder, next };\n      })\n    );\n  }\n  return forEachFolder(rootFolders);\n};\n\nexport const apiAddOrganizationToPageUrl = (id: string) => {\n  const url = new URL(window.location.href);\n  url.searchParams.append(ORG_ID_KEY, id);\n  // sessionStorage.clear();\n  window.history.replaceState(null, document.title, url.toString());\n};\n\nexport const apiLocaleInCookie = () => {\n  return Cookies.get(LOCALE_KEY)?.slice(0, 2);\n};\n\nexport const subscribeLocaleInCookie = (handler: { (locale: string): any }) => {\n  let cache = apiLocaleInCookie();\n  setInterval(() => {\n    const current = apiLocaleInCookie();\n    if (cache === current) return;\n    cache = current;\n    if (current) handler(current);\n  }, 1000);\n};\n\nexport function domainSwitch() {\n  return window.location.host.includes(\"kidsloop.live\");\n}\n\nexport function apiIsEnableReport() {\n  return process.env.REACT_APP_ENABLE_REPORT === \"1\";\n}\nexport function getIsEnableNewGql() {\n  return process.env.REACT_APP_USE_LEGACY_GQL === \"0\";\n}\nexport const enableNewGql = getIsEnableNewGql();\n\nexport const enableReviewClass = process.env.REACT_APP_ENABLE_REVIEW_CLASS === \"1\";\n\nexport async function apiSkillsListByIds(skillIds: string[]) {\n  const skillsQuery = skillIds\n    .map(\n      (id, index) => `\n    skill${index}: subcategoryNode(id: \"${id}\") {\n      id\n      name\n      status\n    }\n    `\n    )\n    .join(\"\");\n  const skillsResult = skillIds.length\n    ? await gqlapi.query<{ [key: string]: LinkedMockOptionsItem }, {}>({\n        query: gql`\n    query skillsListByIds {\n      ${skillsQuery}\n    } \n    `,\n      })\n    : { data: {} };\n  return skillsResult;\n}\n\nexport async function apiDevelopmentalListIds(developmental: string[]) {\n  const developmentalQuery = developmental\n    .map(\n      (id, index) => `\n    developmental${index}: categoryNode(id: \"${id}\") {\n      id\n      name\n      status\n    }\n    `\n    )\n    .join(\"\");\n  const developmentalResult = developmental.length\n    ? await gqlapi.query<{ [key: string]: LinkedMockOptionsItem }, {}>({\n        query: gql`\n    query developmentalListByIds {\n      ${developmentalQuery}\n    } \n    `,\n      })\n    : { data: {} };\n  return developmentalResult;\n}\nexport interface IApiGetPartPermissionResp {\n  error: boolean;\n  data: ICacheData;\n}\n\nexport async function apiGetPartPermission(permissions: string[]): Promise<IApiGetPartPermissionResp> {\n  const organization_id = ((await apiWaitForOrganizationOfPage()) as string) || \"\";\n\n  if (enableNewGql) {\n    const permissionIds = uniq(permissions)\n      .map((item) => {\n        return `\"${item}\"`;\n      })\n      .join(\",\");\n    return await gqlapi\n      .query({\n        query: gql`\n        query{\n          myUser{\n            hasPermissionsInOrganization(\n              organizationId: \"${organization_id}\",\n              permissionIds: [\n                ${permissionIds}\n              ]\n            ){\n              permissionId\n              allowed\n            }\n          }\n        }\n      `,\n      })\n      .then((resp) => {\n        return {\n          error: (resp.errors || []).length > 0 || resp.data?.myUser?.hasPermissionsInOrganization === null,\n          data: (resp.data?.myUser?.hasPermissionsInOrganization || []).reduce(\n            (prev: { [x: string]: any }, cur: { permissionId: string | number; allowed: any }) => {\n              prev[cur.permissionId] = cur.allowed;\n              return prev;\n            },\n            {}\n          ),\n        };\n      });\n  } else {\n    const fragmentStr = permissions\n      .map((permission) => {\n        return `${permission}: checkAllowed(permission_name: \"${permission}\")`;\n      })\n      .join(\",\");\n    return await gqlapi\n      .query({\n        query: gql`\n      query{\n        meMembership: me{\n          membership(organization_id: \"${organization_id}\"){\n            ${fragmentStr}\n          }\n        }\n      }\n    `,\n      })\n      .then((resp) => {\n        return {\n          error: (resp.errors || []).length > 0 || resp.data?.meMembership?.membership === null,\n          data: resp.data?.meMembership?.membership || {},\n        };\n      });\n  }\n}\n\nconst idToNameMap = new Map<string, string>();\n\nexport async function apiGetUserNameByUserId(userIds: string[]): Promise<Map<string, string>> {\n  const fragmentStr = userIds\n    .filter((id) => !idToNameMap.has(id))\n    .map((userId, index) => {\n      return enableNewGql\n        ? `\n          user_${index}: userNode(id: \"${userId}\"){\n            id,\n            givenName \n            familyName\n          }\n        `\n        : `\n          user_${index}: user(user_id: \"${userId}\"){\n            user_id,\n            given_name\n            family_name\n          }\n        `;\n    })\n    .join(\",\");\n  if (!fragmentStr) return idToNameMap;\n  try {\n    const userQuery = await gqlapi.query({\n      query: gql`\n        query userNameByUserIdQuery{\n          ${fragmentStr}\n        },\n        \n      `,\n    });\n    for (const item in userQuery.data || {}) {\n      const user = userQuery.data[item];\n      if (user) {\n        enableNewGql\n          ? idToNameMap.set(user.id, `${user.givenName} ${user.familyName}`)\n          : idToNameMap.set(user.user_id, `${user.given_name} ${user.family_name}`);\n      }\n    }\n  } catch (e) {\n    console.log(e);\n  }\n  return idToNameMap;\n}\n\nexport async function getUserIdAndOrgId() {\n  const organizationId = ((await apiWaitForOrganizationOfPage()) as string) || \"\";\n\n  return organizationId;\n}\n\nexport const refreshToken = async () => {\n  const resp = await fetch(`${process.env.REACT_APP_AUTH_API}/refresh`, { credentials: \"include\" })\n    .then((resp) => resp.json())\n    .then((data) => data);\n  return resp;\n};\n\nexport const uploadFile = async (path: string, body: any) => {\n  const resp = await fetch(path, { method: \"PUT\", body }).then((resp) => resp.json);\n  return resp;\n};\n\nexport async function getProgramIdByProgramName(names: string[]) {\n  let nameToProgramArray: ProgramsObjProps[] = [];\n  if(names.length === 0) return nameToProgramArray;\n  const orgId = apiOrganizationOfPage();\n  const queryStr = names.map((name, index) => {\n    const filter = `{\n      AND: [\n        {\n          OR: [\n            {organizationId: {\n              operator: eq,\n              value: \"${orgId}\"\n            }},\n            {system: {operator: eq, value: true}}\n          ]\n        },\n        {name: {\n            operator: eq,\n            value: \"${name}\",\n            caseInsensitive: false\n        }},\n        {status: {\n          operator: eq, \n          value: \"active\"\n        }}\n      ]\n    }`;\n    return `q_${index}: programsConnection(filter: ${filter}, direction: ${ConnectionDirection.Forward}){\n      edges{\n        node{\n          id,\n          name,\n          ageRangesConnection {\n            edges {\n              node {\n                id\n                name\n                status\n                system\n              }\n            }\n          },\n          gradesConnection {\n            edges {\n              node {\n                id\n                name\n                status\n                system\n              }\n            }\n          }\n        }\n      }\n    }`\n  }).join(\",\");\n  try {\n  const programResult = await gqlapi.query({\n    query: gql`\n      query getProgramIdByName{\n        ${queryStr}\n      }\n      `\n    });\n  for(const item in programResult.data || {}) {\n    const program = programResult.data[item];\n    if(program && program.edges.length >= 1){\n      program.edges.forEach((pItem: { node: { ageRangesConnection: any; gradesConnection: any; id: any; name: any; }; }, index: number) => {\n        if(index === 0) {\n          const age = pItem.node.ageRangesConnection;\n          const grade = pItem.node.gradesConnection;\n          nameToProgramArray.push({\n            id: pItem.node.id,\n            name: pItem.node.name,\n            ages: age.edges.map((aItem: { node: { id: any; name: any; system: any; status: any; }; }) => {\n              return {\n                id: aItem.node.id,\n                name: aItem.node.name,\n                system: aItem.node.system,\n                status: aItem.node.status\n              }\n            }),\n            grades: grade.edges.map((gItem: { node: { id: any; name: any; system: any; status: any; }; }) => {\n              return {\n                id: gItem.node.id,\n                name: gItem.node.name,\n                system: gItem.node.system,\n                status: gItem.node.status\n              }\n            })\n          })\n        }\n      })\n    }\n  }\n} catch (e) {\n  console.log(e)\n}\n  return nameToProgramArray;\n}\n\nexport async function getSubjectIdByProgramIdAndSubjectName(programId: string, subjectNames: string[]): Promise<SubjectObjProps[]>{\n  const orgId = apiOrganizationOfPage();\n  let nameToSubjectArray: SubjectObjProps[] = [];\n  const queryStr = subjectNames\n  .map((name, index) => {\n    const filterStr = `{\n      AND: [\n        {\n          OR: [\n            {\n              organizationId: {\n                operator: eq,\n                value: \"${orgId}\"\n              }\n            },\n            {\n              system: {\n                operator: eq, \n                value: true\n              }\n            }\n          ],\n          AND: [{\n              name: {\n                operator: contains, \n                value: \"${name}\", \n                caseInsensitive: true\n              },\n              programId: {\n                operator: eq,\n                value: \"${programId}\"\n              }\n          }]\n        }\n      ],\n      status: {operator: eq, value: \"active\"}\n    }`\n    return `q_${index}: subjectsConnection(filter: ${filterStr}, direction: ${ConnectionDirection.Forward}){\n      edges {\n        node {\n          id,\n          name,\n          status,\n          system,\n          categoriesConnection{\n            edges{\n              node {\n                 id,\n         \t\t\t\t name,\n                system,\n                status,\n                subcategoriesConnection{\n                  edges{\n                    node {\n                       id,\n                        name,\n                      system,\n                      status,\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }`\n  }).join(\",\");\n  try {\n    const subjectResult = await gqlapi.query({\n      query: gql`\n        query getSubjectIdByName{${queryStr}}\n      `\n    })\n    for (const item in subjectResult.data || {}) {\n      const subject = subjectResult.data[item];\n      if(subject && subject.edges.length >= 1) {\n        subject.edges.forEach((sItem: { node: { id: string, name: string, categoriesConnection: any }; }, index: number) => {\n          if(index === 0) {\n            const category = sItem.node.categoriesConnection\n            nameToSubjectArray.push({\n              id: sItem.node.id,\n              name: sItem.node.name,\n              category: category.edges.map((cItem: { node: { id: string; name: string; system: boolean; status: string; subcategoriesConnection: any }; }) => {\n                if(cItem) {\n                  const subcategory = cItem.node.subcategoriesConnection;\n                  return {\n                    id: cItem.node.id,\n                    name: cItem.node.name,\n                    system: cItem.node.system,\n                    status: cItem.node.status,\n                    subCategory: subcategory.edges.map((scItem: { node: { id: any; name: any; system: any; status: any; }; }) => {\n                      return {\n                        id: scItem.node.id,\n                        name: scItem.node.name,\n                        system: scItem.node.system,\n                        status: scItem.node.status,\n                      }\n                    })\n                  }\n                } else {\n                  return undefined\n                }\n              })\n            })\n          }\n        })\n      }\n    }\n  } catch (e) {\n    console.log(e)\n  }\n  return nameToSubjectArray;\n}\n\nexport async function getGradeIdByProgramIdAndGradeName(programId: string, gradeNames: string[]) {\n}\nexport function isEnableUpload() {\n  return process.env.REACT_APP_ENABLE_UPLOAD_LO === \"1\"\n}\n\n\n\n\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}