"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _shared = require("@rpldy/shared");

var _queue = _interopRequireDefault(require("./queue"));

var _batchItemsSender = _interopRequireDefault(require("./batchItemsSender"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

var _default = function _default(trigger, options, uploaderId) {
  // $FlowFixMe - https://github.com/facebook/flow/issues/8215
  var cancellable = (0, _shared.triggerCancellable)(trigger),
      sender = (0, _batchItemsSender["default"])(),
      queue = (0, _queue["default"])(options, cancellable, trigger, sender, uploaderId);

  var process = function process(batch, batchOptions) {
    queue.uploadBatch(batch, batchOptions);
  };

  var abortBatch = function abortBatch(batchId) {
    queue.abortBatch(batchId);
  };

  var abort = function abort(id) {
    if (id) {
      queue.abortItem(id);
    } else {
      queue.abortAll();
    }
  };

  return {
    process: process,
    abortBatch: abortBatch,
    abort: abort
  };
};

exports["default"] = _default;